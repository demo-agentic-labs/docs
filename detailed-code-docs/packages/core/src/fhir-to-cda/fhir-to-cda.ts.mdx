---
title: "fhir-to-cda.ts"
---

## High-level description
This code defines a function `convertFhirBundleToCda` that converts FHIR (Fast Healthcare Interoperability Resources) Bundles to CDA (Clinical Document Architecture) documents. It processes one or more FHIR Bundles and generates corresponding CDA documents in string format.

## Code Structure
The main function `convertFhirBundleToCda` uses the `generateCdaFromFhirBundle` function from the imported `cda-generators` module to perform the actual conversion. The `toArray` utility function is used to ensure the input is always treated as an array.

## References
- `generateCdaFromFhirBundle` from "./cda-generators"
- `toArray` from "@metriport/shared"

## Symbols

### `convertFhirBundleToCda`
#### Description
This function converts one or more FHIR Bundles to CDA documents. It handles both single Bundle and array of Bundles as input.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fhirBundle | Bundle \| Bundle[] | A single FHIR Bundle or an array of FHIR Bundles containing Compositions and correlated resources |
| orgOid | string | Organization's Object Identifier |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | string[] | Array of CDA documents in string format |

#### Internal Logic
1. Convert the input `fhirBundle` to an array using the `toArray` function.
2. Map over each bundle in the array, applying the `generateCdaFromFhirBundle` function to convert it to a CDA document.
3. Return the array of generated CDA documents.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @medplum/fhirtypes | Provides the `Bundle` type definition |
| @metriport/shared | Provides the `toArray` utility function |

## API/Interface Reference
| Function | Input | Output | Description |
|:---------|:------|:-------|:------------|
| convertFhirBundleToCda | (fhirBundle: Bundle \| Bundle[], orgOid: string) | string[] | Converts FHIR Bundles to CDA documents |

This function serves as the main entry point for converting FHIR Bundles to CDA documents. It can be used in various contexts where such conversion is needed, such as in healthcare data integration or interoperability scenarios.