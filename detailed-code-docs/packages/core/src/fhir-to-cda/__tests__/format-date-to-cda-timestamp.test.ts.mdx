---
title: "format-date-to-cda-timestamp.test.ts"
---

## High-level description
This file contains unit tests for the `formatDateToCdaTimestamp` function, which is responsible for converting various date and time formats to a specific CDA (Clinical Document Architecture) timestamp format. The tests cover different scenarios, including handling undefined inputs, various date-time formats, and different timezone offsets.

## Symbols

### `describe("formatDateToCdaTimestamp", () =&gt; { ... })`
#### Description
This is the main test suite for the `formatDateToCdaTimestamp` function. It contains multiple test cases to verify the function's behavior under different input scenarios.

### `it("should return undefined if dateString is undefined", () =&gt; { ... })`
#### Description
This test case verifies that the function returns `undefined` when given an undefined input.

#### Internal Logic
1. Call `formatDateToCdaTimestamp` with `undefined` as the argument.
2. Assert that the result is `undefined`.

### `it("should format date-time string with milliseconds correctly", () =&gt; { ... })`
#### Description
This test case checks if the function correctly formats a date-time string that includes milliseconds.

#### Internal Logic
1. Define a date-time string with milliseconds: `"2024-05-22T02:25:16.443Z"`.
2. Call `formatDateToCdaTimestamp` with this date-time string.
3. Assert that the result is `"20240522022516"`.

### `it("should format date-only string correctly", () =&gt; { ... })`
#### Description
This test case verifies that the function correctly handles a date-only string input.

#### Internal Logic
1. Define a date-only string: `"1969-04-20"`.
2. Call `formatDateToCdaTimestamp` with this date string.
3. Assert that the result is `"19690420"`.

### `it("should format date-time string without milliseconds correctly", () =&gt; { ... })`
#### Description
This test case checks if the function correctly formats a date-time string without milliseconds.

#### Internal Logic
1. Define a date-time string without milliseconds: `"2024-05-22T02:25:16Z"`.
2. Call `formatDateToCdaTimestamp` with this date-time string.
3. Assert that the result is `"20240522022516"`.

### `it('should format date-time string without "Z" correctly', () =&gt; { ... })`
#### Description
This test case verifies that the function correctly handles a date-time string without the "Z" UTC indicator.

#### Internal Logic
1. Define a date-time string without "Z": `"2024-05-22T02:00:00.000"`.
2. Call `formatDateToCdaTimestamp` with this date-time string.
3. Assert that the result is `"20240522"`.

### `it("should format date-time string with positive timezone offset correctly", () =&gt; { ... })`
#### Description
This test case checks if the function correctly handles a date-time string with a positive timezone offset.

#### Internal Logic
1. Define a date-time string with a positive timezone offset: `"2024-05-22T02:25:16.443+02:00"`.
2. Call `formatDateToCdaTimestamp` with this date-time string.
3. Assert that the result is `"20240522002516"`.

### `it("should format date-time string with negative timezone offset correctly", () =&gt; { ... })`
#### Description
This test case verifies that the function correctly handles a date-time string with a negative timezone offset.

#### Internal Logic
1. Define a date-time string with a negative timezone offset: `"2024-05-22T02:25:16.443-07:00"`.
2. Call `formatDateToCdaTimestamp` with this date-time string.
3. Assert that the result is `"20240522092516"`.

### `it("should format invalid date string correctly", () =&gt; { ... })`
#### Description
This test case checks how the function handles an invalid date string input.

#### Internal Logic
1. Define an invalid date string: `"invalid-date-string"`.
2. Call `formatDateToCdaTimestamp` with this invalid date string.
3. Assert that the result matches the output of `dayjs(invalidDate).format("YYYYMMDDHHmmss")`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| `formatDateToCdaTimestamp` | The function being tested, imported from "../cda-templates/commons" |
| `dayjs` | A date manipulation library used for handling invalid date strings |

Note: The `dayjs` library is used in the last test case to handle invalid date strings, which suggests that the `formatDateToCdaTimestamp` function internally uses `dayjs` for date parsing and formatting.