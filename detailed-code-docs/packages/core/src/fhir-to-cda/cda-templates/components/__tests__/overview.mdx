---
title: "Overview"
---

## High-level description
This directory contains unit tests for various components of the FHIR to CDA conversion process. The tests cover different aspects of the conversion, including allergies, conditions, encounters, family history, immunizations, medications, mental status, problems, social history, and vital signs. The tests are designed to verify the correct mapping of FHIR resources to CDA format and ensure the proper handling of various scenarios and edge cases.

## What does it do?
The tests in this directory serve several purposes:

1. Verify the correct conversion of FHIR resources to CDA format for different clinical data types.
2. Ensure that the conversion process handles various scenarios, such as multiple resources, missing data, and different date formats.
3. Check that the generated CDA XML output matches expected templates.
4. Validate the proper grouping and organization of related clinical data.
5. Test error handling and edge cases in the conversion process.

The tests use mock FHIR data, generated using utility functions, to simulate real-world clinical scenarios. They then compare the output of the conversion functions with pre-defined XML templates to ensure accuracy and consistency.

## Key Files
1. `allergies.test.ts`: Tests the conversion of FHIR AllergyIntolerance resources to CDA format.
2. `condition-examples.ts`: Provides example FHIR Condition resources for testing purposes.
3. `encompassing-enc.test.ts`: Tests the creation of the Encompassing Encounter section in CDA from FHIR Encounter resources.
4. `family-history.test.ts`: Verifies the conversion of FHIR FamilyMemberHistory resources to CDA format.
5. `immunization.test.ts`: Tests the conversion of FHIR Immunization resources to CDA format.
6. `medications.test.ts`: Checks the conversion of FHIR MedicationStatement and Medication resources to CDA format.
7. `mental-status.test.ts`: Tests the processing of mental status observations from FHIR to CDA format.
8. `problems.test.ts`: Verifies the conversion of FHIR Condition resources to the CDA Problems section.
9. `social-history.test.ts`: Tests the construction of the social history section in CDA from FHIR Observation resources.
10. `vital-signs.test.ts`: Checks the conversion and grouping of FHIR vital signs observations to CDA format.

## Dependencies
The tests rely on several key dependencies:

1. @faker-js/faker: Used for generating random test data.
2. @medplum/fhirtypes: Provides TypeScript types for FHIR resources.
3. lodash: Utility library for various operations.
4. path: Used for handling file paths when loading XML templates.
5. xmlBuilder: Used for converting JSON objects to XML format.
6. dayjs: Date manipulation library.

## Configuration
The tests use pre-generated XML templates for comparison with the generated output. These templates are stored in separate files and loaded using the `getXmlContentFromFile` function. The tests also use various utility functions from the `shared.ts` file for creating mock FHIR resources and handling dates.

Many of the test suites are currently skipped (`describe.skip`), indicating that they may be under development or temporarily disabled. This configuration allows developers to focus on specific tests or components during the development process.