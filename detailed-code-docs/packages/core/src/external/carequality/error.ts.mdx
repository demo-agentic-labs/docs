---
title: "error.ts"
---

## High-level description
This code defines error classes and utility functions for handling errors in the context of IHE (Integrating the Healthcare Enterprise) Gateway operations, specifically for Carequality interactions. It provides a structured way to create, handle, and respond to various error scenarios in patient discovery, document query, and document retrieval processes.

## Code Structure
The code defines a base `IHEGatewayError` class that extends `MetriportError`, and several specific error classes that inherit from `IHEGatewayError`. It also includes utility functions for constructing error responses for different types of requests (Document Query, Document Retrieval, and Patient Discovery).

## Symbols

### `IHEGatewayError`
#### Description
A base error class for IHE Gateway-related errors, extending `MetriportError`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | string | Error message |
| cause | unknown | Optional cause of the error |
| iheErrorCode | string | Optional IHE-specific error code |
| statusCode | number | HTTP status code (default: 500) |

### `PatientAddressRequestedError`
#### Description
Error class for when a patient's address is not defined.

### `LivingSubjectAdministrativeGenderRequestedError`
#### Description
Error class for when a patient's gender at birth is not defined.

### `XDSRegistryError`
#### Description
Error class for general XDS (Cross-Enterprise Document Sharing) registry errors.

### `XDSUnknownPatientId`
#### Description
Error class for when a patient ID is unknown.

### `XDSMissingHomeCommunityId`
#### Description
Error class for when a home community ID is missing.

### `XDSUnknownCommunity`
#### Description
Error class for when a community is unknown.

### `constructBaseErrorResponse`
#### Description
Constructs a base error response object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| payload | InboundDocumentQueryReq \| InboundDocumentRetrievalReq \| InboundPatientDiscoveryReq | The original request payload |
| error | IHEGatewayError | Optional error object |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| baseResponse | BaseErrorResponse | A base error response object |

### `constructDQErrorResponse`
#### Description
Constructs an error response for Document Query requests.

### `constructDRErrorResponse`
#### Description
Constructs an error response for Document Retrieval requests.

### `constructPDNoMatchResponse`
#### Description
Constructs a response for Patient Discovery requests when no match is found.

### `constructPDErrorResponse`
#### Description
Constructs an error response for Patient Discovery requests.

## Constants
- `httpErrorCode`: Represents an HTTP error code.
- `schemaErrorCode`: Represents a schema error code.

## Dependencies
The code imports types and interfaces from `@metriport/ihe-gateway-sdk` and uses the `MetriportError` class from `"../../util/error/metriport-error"`.

## Error Handling
This module is primarily focused on error handling. It defines various error classes and provides utility functions to construct error responses for different types of IHE Gateway operations.