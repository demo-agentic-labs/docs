---
title: "create-metadata-xml.ts"
---

## High-level description
This code defines a function `createExtrinsicObjectXml` that generates an XML representation of an Extrinsic Object for use in healthcare document metadata. It's part of a system for managing and exchanging healthcare documents, likely in compliance with IHE (Integrating the Healthcare Enterprise) standards.

## Code Structure
The `createExtrinsicObjectXml` function takes various parameters related to a healthcare document and its metadata, and constructs an XML string representing this information in a standardized format.

## Symbols

### `createExtrinsicObjectXml`
#### Description
This function creates an XML representation of an Extrinsic Object, which is used to describe metadata for a healthcare document.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| createdTime | string | The creation time of the document |
| organization | Organization \| undefined | The organization associated with the document |
| size | string | The size of the document |
| patientId | string | The unique identifier for the patient |
| classCode | CodeableConcept \| undefined | The class code for the document |
| practiceSettingCode | CodeableConcept \| undefined | The practice setting code |
| healthcareFacilityTypeCode | CodeableConcept \| undefined | The healthcare facility type code |
| documentUniqueId | string | A unique identifier for the document |
| title | string \| undefined | The title of the document |
| mimeType | string | The MIME type of the document |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| metadataXml | string | The XML string representing the Extrinsic Object |

#### Internal Logic
1. Generate a new UUID for the document using `uuidv7()`.
2. Extract various codes and values from the input parameters, using default values where necessary.
3. Construct the XML string using template literals, incorporating all the metadata fields.
4. The XML includes several sections:
   - Basic document information (creation time, language, size, etc.)
   - Author information
   - Various classification elements (class code, confidentiality, format, etc.)
   - Patient and document identifiers

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @medplum/fhirtypes | Provides types for FHIR resources |
| ../shared | Imports various constants and utility functions |
| ../../../util/uuid-v7 | Provides UUID generation functionality |

## Error Handling
This function doesn't include explicit error handling. It assumes that all input parameters are valid and doesn't check for potential issues like missing required fields.

## Performance Considerations
The function constructs a large XML string using template literals. For very large documents or high-frequency calls, this could potentially be a performance bottleneck. Consider using a streaming XML writer for better performance in such cases.

## TODOs
There are no explicit TODOs in the code.

This function plays a crucial role in generating standardized metadata for healthcare documents, which is essential for interoperability in healthcare information systems. It's important to ensure that all generated XML conforms to the required standards and includes all necessary information for document exchange and retrieval.