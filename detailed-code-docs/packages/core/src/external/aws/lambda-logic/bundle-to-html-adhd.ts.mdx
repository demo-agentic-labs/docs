---
title: "bundle-to-html-adhd.ts"
---

## High-level description
This code defines a function `bundleToHtmlADHD` that converts a FHIR Bundle to an HTML representation specifically tailored for ADHD (Attention Deficit Hyperactivity Disorder) related medical records. It extracts various types of medical information from the bundle and organizes them into a structured HTML document.

## Code Structure
The main function `bundleToHtmlADHD` takes a FHIR Bundle and an optional Brief object as input. It extracts different types of medical resources from the bundle, processes them, and generates an HTML document with sections for each type of medical information. The code also includes several helper functions for formatting and organizing the data.

## Symbols

### `bundleToHtmlADHD`
#### Description
This is the main function that converts a FHIR Bundle to an HTML representation for ADHD-related medical records.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fhirBundle | Bundle | The FHIR Bundle containing medical data |
| brief | Brief (optional) | Additional brief information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| htmlPage | string | The generated HTML page as a string |

#### Internal Logic
1. Extracts FHIR types from the bundle using `extractFhirTypesFromBundle`.
2. Checks if the bundle contains clinically relevant data.
3. If no clinically relevant data is found, returns a simple HTML page stating this.
4. If a patient is not found in the bundle, throws an error.
5. Processes Annual Wellness Visits and ADHD Visits.
6. Generates an HTML page with various sections for different types of medical information.

### `extractFhirTypesFromBundle`
#### Description
Extracts different types of FHIR resources from the given bundle and organizes them into a structured object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| bundle | Bundle | The FHIR Bundle to extract resources from |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| FhirTypes | object | An object containing arrays of different FHIR resource types |

### Helper Functions
The code includes several helper functions for creating different sections of the HTML document, such as:
- `createMRHeader`
- `createFilteredReportSection`
- `createDiagnosticReportsSection`
- `createMedicationSection`
- `createConditionSection`
- `createAllergySection`
- `createProcedureSection`
- `createObservationSocialHistorySection`
- `createObservationVitalsSection`
- `createObservationLaboratorySection`
- `createOtherObservationsSection`
- `createImmunizationSection`
- `createFamilyHistorySection`
- `createRelatedPersonSection`
- `createTaskSection`
- `createEncountersSection`
- `createCoverageSection`

Each of these functions processes a specific type of medical information and generates the corresponding HTML section.

## Dependencies
The code relies on several external libraries and modules:
- Various FHIR types from "@medplum/fhirtypes"
- dayjs for date manipulation
- lodash for utility functions
- Other custom modules like "bundle-to-brief" and "bundle-to-html"

## Configuration
The code defines several constants for coding systems:
- RX_NORM_CODE
- NDC_CODE
- SNOMED_CODE
- ICD_10_CODE
- LOINC_CODE
- MEDICARE_CODE
- CPT_CODE
- UNK_CODE
- UNKNOWN_DISPLAY

These are used for identifying and processing specific types of medical codes in the FHIR data.

## Error Handling
The code includes basic error handling, such as throwing an error if no patient is found in the bundle. However, most of the error handling is left to the caller of the `bundleToHtmlADHD` function.

## Logging
There is no explicit logging implemented in this code. Any logging would need to be handled by the caller of the `bundleToHtmlADHD` function.