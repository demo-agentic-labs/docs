---
title: "Overview"
---

## High-level description
This directory contains modules for integrating with various external services and APIs within the Metriport healthcare interoperability system. It includes implementations for analytics, AWS services, Carequality, CommonWell Health Alliance, FHIR (Fast Healthcare Interoperability Resources), OpenSearch, and Slack notifications.

## What does it do?
The code in this directory provides a wide range of functionalities:

1. Analytics: Tracks and analyzes various events and user actions using PostHog.

2. AWS Integration: Interacts with AWS services like S3, Lambda, SQS, Secrets Manager, and Location Services. It also includes specialized modules for document signing and AI-powered medical record summarization.

3. Carequality Integration: Facilitates secure healthcare information exchange between different providers using IHE (Integrating the Healthcare Enterprise) standards.

4. CDA (Clinical Document Architecture) Handling: Processes and generates CDA XML structures, including test data generation and document processing.

5. CommonWell Health Alliance Integration: Enhances patient data coverage across different healthcare organizations and manages document operations.

6. FHIR API Client: Interacts with FHIR servers, processes FHIR resources, and handles various aspects of FHIR data management.

7. OpenSearch Integration: Provides functionality for file ingestion, searching, and document processing using OpenSearch.

8. Slack Notifications: Sends notifications and alerts to Slack channels.

9. Medical Data Source Management: Defines and validates medical data sources used across the application.

These functionalities work together to create a comprehensive system for healthcare data interoperability, allowing Metriport to integrate with various healthcare information exchange networks, process and store medical data, and provide analytics and notifications.

## Entry points
The main entry points vary for each subdirectory, but generally include:

1. API client classes and factory functions for external services (e.g., AWS, FHIR, OpenSearch).
2. High-level functions for data retrieval, processing, and consolidation.
3. Utility functions for handling specific data formats (e.g., CDA, FHIR resources).
4. Integration points with healthcare information exchange networks (Carequality, CommonWell).

## Key Files
While each subdirectory has its own important files, some key files across the directory include:

1. `analytics/index.ts`: Implements analytics tracking using PostHog.
2. `aws/lambda-logic/`: Contains Lambda functions for FHIR bundle processing and document management.
3. `carequality/ihe-gateway-v2.ts`: Defines the abstract `IHEGatewayV2` class for IHE Gateway operations.
4. `commonwell/management/api-factory.ts`: Creates instances of `CommonWellManagementAPI`.
5. `fhir/api/api-factory.ts`: Provides factory functions for creating FHIR API client instances.
6. `opensearch/file-ingestor-direct.ts` and `file-searcher-direct.ts`: Implement direct file ingestion and searching in OpenSearch.
7. `slack/index.ts`: Provides functions for sending notifications and alerts to Slack.

## Dependencies
The code relies on various external libraries and services, including:

1. AWS SDK for AWS service interactions
2. PostHog for analytics
3. axios for HTTP requests
4. @medplum/core and @medplum/fhirtypes for FHIR functionalities
5. @opensearch-project/opensearch for OpenSearch interactions
6. dayjs for date manipulation
7. zod for schema validation
8. Various internal Metriport packages (@metriport/shared, @metriport/commonwell-sdk, etc.)

## Configuration
The implementation uses various configuration options, typically managed through environment variables or a centralized configuration system. These include:

1. API endpoints and credentials for external services
2. AWS region settings and resource identifiers
3. FHIR server URLs
4. OpenSearch connection details
5. Slack webhook URLs
6. Performance tuning parameters

In conclusion, this `external` directory provides a comprehensive set of integrations and utilities for the Metriport healthcare interoperability system. It enables interaction with various healthcare information exchange networks, processes different medical data formats, and integrates with cloud services for storage, processing, and analytics. The modular structure allows for easy maintenance and extension of functionalities as needed.