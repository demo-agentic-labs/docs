---
title: "Overview"
---

## High-level description
This directory contains code for integrating with OpenSearch, an open-source search and analytics engine. It includes functionality for file ingestion, searching, and document processing, with support for both direct interactions and SQS-based operations.

## What does it do?
The code in this directory provides a set of tools and classes for:

1. Ingesting files into OpenSearch, including content cleanup and processing.
2. Searching for files and documents within OpenSearch indexes.
3. Managing OpenSearch connections and configurations.
4. Handling different file types and formats, particularly focusing on medical documents and CDA (Clinical Document Architecture) files.
5. Integrating with AWS services like S3 and SQS for file storage and message handling.

The workflow typically involves:
1. Receiving a file or document to be ingested.
2. Cleaning and processing the content, removing unnecessary HTML tags and formatting.
3. Storing the processed content in OpenSearch for later retrieval.
4. Providing search capabilities to query the stored documents based on various criteria.

## Entry points
The main entry points for this directory are:

1. `file-ingestor-direct.ts`: Implements direct file ingestion into OpenSearch.
2. `file-ingestor-sqs.ts`: Implements file ingestion using SQS for message handling.
3. `file-searcher-direct.ts`: Implements direct searching of files in OpenSearch.
4. `search-documents.ts`: Provides high-level functions for searching documents across various healthcare information exchanges.

The `file-search-connector-factory.ts` file serves as a factory for creating instances of file ingestors and searchers based on the current configuration.

## Key Files
1. `cda.ts`: Defines stop words for text processing, particularly for CDA files.
2. `file-ingestor.ts`: Defines the abstract base class for file ingestion.
3. `file-searcher.ts`: Defines interfaces and types for file searching.
4. `index.ts`: Provides utility functions and type definitions for working with OpenSearch.

## Dependencies
The code relies on several external libraries and AWS services:

1. @opensearch-project/opensearch: For interacting with OpenSearch.
2. aws-sdk: For AWS service interactions (S3, SQS).
3. dayjs: For date and time manipulation.
4. @medplum/fhirtypes: For FHIR (Fast Healthcare Interoperability Resources) type definitions.
5. @metriport/commonwell-sdk: For CommonWell Health Alliance integration.
6. lodash: For utility functions.

## Configuration
The code uses a configuration system, likely based on environment variables, to manage settings such as:

1. AWS region
2. OpenSearch endpoint
3. Index name
4. Authentication credentials
5. SQS queue URLs

The `Config` object is used throughout the code to retrieve these configuration values.

In summary, this directory provides a comprehensive set of tools for integrating OpenSearch into a healthcare-focused application, with a particular emphasis on document processing, storage, and retrieval. It offers flexibility in deployment options (direct or SQS-based) and includes utilities for handling medical document formats like CDA.