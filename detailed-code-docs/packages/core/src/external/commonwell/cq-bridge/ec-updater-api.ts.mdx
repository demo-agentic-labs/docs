---
title: "ec-updater-api.ts"
---

## High-level description
This code defines an `ECUpdaterAPI` class that extends `ECUpdater` to provide API-based methods for updating Enhanced Coverage (EC) information after include list and document query operations in a CommonWell Health Alliance context.

## Code Structure
The `ECUpdaterAPI` class extends the `ECUpdater` base class and implements two methods: `storeECAfterIncludeList` and `storeECAfterDocQuery`. These methods make HTTP POST requests to specific API endpoints to update EC information.

## Symbols

### `ECUpdaterAPI`
#### Description
A class that provides API-based methods for updating Enhanced Coverage (EC) information.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| apiUrl | string | The base URL for the API endpoints |

#### Internal Logic
The class constructor initializes the `apiUrl` property.

### `storeECAfterIncludeList`
#### Description
Updates EC information after an include list operation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ecId | string | Enhanced Coverage ID |
| cxId | string | Customer ID |
| patientIds | string[] | Array of patient IDs |
| cqOrgIds | string[] | Array of CQ organization IDs |

#### Internal Logic
1. Constructs the API endpoint URL
2. Logs the API call details
3. Creates URL parameters
4. Sends a POST request to the API endpoint with the parameters
5. Uses a timeout of 2 minutes for the request

### `storeECAfterDocQuery`
#### Description
Updates EC information after a document query operation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ecId | string | Enhanced Coverage ID |
| cxId | string | Customer ID |
| patientId | string | Patient ID |
| docsFound | number | Number of documents found |

#### Internal Logic
1. Constructs the API endpoint URL
2. Logs the API call details
3. Creates URL parameters
4. Sends a POST request to the API endpoint with the parameters
5. Uses a timeout of 2 minutes for the request

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| axios | Making HTTP requests |
| dayjs | Date and time manipulation |

## Error Handling
The code doesn't implement explicit error handling. Errors from the axios requests will be propagated to the caller.

## Performance Considerations
Both API methods use a 2-minute timeout, which may be excessive for some network conditions. Consider adjusting this timeout based on typical response times from the API.