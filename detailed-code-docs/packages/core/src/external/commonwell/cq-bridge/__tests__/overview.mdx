---
title: "Overview"
---

## High-level description
This directory contains test files for the CommonWell Query Bridge (CQ Bridge) functionality within the core package of the application. The tests cover various aspects of organization handling, coverage enhancement, and data retrieval related to CommonWell Health Alliance integration.

## What does it do?
The tests in this directory ensure the correct functioning of several key components:

1. Coverage Enhancement: It verifies that the system can correctly filter and retrieve organizations based on various criteria such as priority, state, and gateway. This is crucial for optimizing the coverage of patient data across different healthcare organizations.

2. Organization Handling: The tests check the functionality for grouping organizations by priority and creating chunks of organizations for processing. This is important for managing large numbers of healthcare organizations efficiently.

3. Mock Data Generation: It includes utility functions for creating mock organization data, which is essential for comprehensive testing of the system's behavior under various scenarios.

4. Data Retrieval: The tests verify that the system can correctly retrieve and process organization data, including handling different priorities and states.

These tests help ensure that the CommonWell integration works correctly, allowing the application to efficiently manage and process data from multiple healthcare organizations.

## Key Files

1. `coverate-enhancer.test.ts`:
   - Tests the `CoverageEnhancer` class, focusing on methods like `getOrgsBy` and `getOrgsForPatients`.
   - Verifies the correct filtering of organizations based on priority, state, and gateway.
   - Ensures proper handling of organization limits and combinations of different priority organizations.

2. `cq-orgs.ts`:
   - Defines the `makeSimpleOrg` utility function for creating mock `CQOrgHydrated` objects.
   - Used across various test files to generate realistic test data for CommonWell organizations.

3. `get-orgs.test.ts`:
   - Tests the `getOrgsByPrio` and `getOrgChunksFromPos` functions from the `get-orgs` module.
   - Verifies correct grouping of organizations by priority and chunking for efficient processing.

## Dependencies
The test files rely on several external libraries and internal modules:

1. Jest: The primary testing framework used across all test files.
2. @faker-js/faker: Used to generate fake data for testing, particularly in `cq-orgs.ts`.
3. lodash: Utilized for various utility functions like `uniq` and `chunk`.
4. @metriport/shared: Provides shared types and enums, such as `USState`.

Internal dependencies include:
- `../coverage-enhancer`
- `../get-orgs`
- `../cq-org-list.json`
- `../../../../command/patient-loader-metriport-api`

## Configuration
The tests use various configuration settings, including:

1. `defaultMaxOrgsToProcess`: A constant used to limit the number of organizations processed in tests, mimicking performance considerations in the actual implementation.

2. Mock states and priorities: The tests use predefined sets of states and priorities to create diverse test scenarios.

3. Chunk sizes: Various tests use different chunk sizes (e.g., 10) to verify the chunking functionality of organization data.

These tests play a crucial role in ensuring the reliability and correctness of the CommonWell Query Bridge functionality, which is essential for the application's ability to interact with and process data from multiple healthcare organizations efficiently.