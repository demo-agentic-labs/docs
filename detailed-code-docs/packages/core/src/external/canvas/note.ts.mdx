---
title: "note.ts"
---

## High-level description
This code defines a function `createFullNote` that creates a comprehensive medical note in the Canvas Medical system. It generates and adds various medical resources such as conditions, medications, and allergies for a patient based on their gender.

## Code Structure
The main function `createFullNote` orchestrates the creation of a note and associated medical resources. It uses the `CanvasSDK` to interact with the Canvas API, and imports data generation functions from `./data` to create fake medical data.

## References
- `CanvasSDK`: Used to interact with the Canvas Medical API
- `generateFakeBundleFemale` and `generateFakeBundleMale`: Functions from `./data` to generate fake medical data
- `out` and `capture`: Utility functions for logging and error capturing

## Symbols

### `createFullNote`
#### Description
Creates a full medical note in the Canvas system, including conditions, medications, and allergies.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| canvas | CanvasSDK | Instance of the Canvas SDK |
| canvasPatientId | string | ID of the patient in Canvas |
| patientA | boolean | Flag for female patient data |
| patientB | boolean | Flag for male patient data |
| providerLastName | string | Last name of the provider |

#### Internal Logic
1. Retrieves practitioner and location information from Canvas.
2. Creates a new note in Canvas.
3. Generates fake medical data based on patient gender (A or B).
4. Iterates through the generated data and creates corresponding resources (allergies, conditions, medications) in Canvas.

#### Error Handling
Wraps the entire function in a try-catch block. If an error occurs, it logs the error, captures it for further analysis, and re-throws the error.

## Side Effects
- Creates multiple resources in the Canvas Medical system (note, allergies, conditions, medications).
- Logs various steps of the process.
- Captures errors for monitoring and analysis.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| CanvasSDK | Interaction with Canvas Medical API |
| generateFakeBundleFemale/Male | Generation of fake medical data |
| out | Logging utility |
| capture | Error capturing utility |

## TODOs
- Remove the practitioner retrieval as per https://github.com/metriport/metriport-internal/issues/2088