---
title: "index.ts"
---

Here's a high-level description and documentation for the provided code:

## High-level description

This file contains utility functions and constants related to FHIR (Fast Healthcare Interoperability Resources) data processing and manipulation. It includes functions for handling FHIR resources, date formatting, error handling, and various helper functions for working with FHIR data structures. The code is part of a larger system for managing and processing healthcare data using the FHIR standard.

## Code Structure

The code is organized into several sections:

1. Imports: Various types and functions are imported from external modules.
2. Constants: Defines separators and other constant values used throughout the code.
3. Utility Functions: A collection of functions for processing FHIR data, including error handling, date formatting, and resource type checking.
4. Resource Type Checks: Functions to determine the type of a given FHIR resource.
5. Resource Finders: Functions to find specific resources within a FHIR Bundle.
6. Reference Builders: Functions to construct references to FHIR resources.

## Symbols

### `operationOutcomeIssueToString`
#### Description
Converts an OperationOutcomeIssue to a string representation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| i | OperationOutcomeIssue | The issue to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | String representation of the issue |

### `getDetailFromOutcomeError`
#### Description
Extracts detailed error information from an OperationOutcomeError.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| err | OperationOutcomeError | The error to process |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | Detailed error message |

### `isUploadedByCustomer`
#### Description
Checks if a DocumentReference was uploaded by a customer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| doc | DocumentReference | The document to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if uploaded by customer, false otherwise |

### `downloadedFromCW`
#### Description
Checks if a DocumentReference was downloaded from CommonWell.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| doc | DocumentReference | The document to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if downloaded from CommonWell, false otherwise |

### `downloadedFromCQ`
#### Description
Checks if a DocumentReference was downloaded from Carequality.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| doc | DocumentReference | The document to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if downloaded from Carequality, false otherwise |

### `downloadedFromHIEs`
#### Description
Checks if a DocumentReference was downloaded from any Health Information Exchange.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| doc | DocumentReference | The document to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if downloaded from any HIE, false otherwise |

### `isoDateRangeToFHIRDateQuery`
#### Description
Converts an ISO date range to a FHIR date query string.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dateFrom | string | Optional start date |
| dateTo | string | Optional end date |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | FHIR date query string |

### `isoDateToFHIRDateQueryFrom`
#### Description
Converts an ISO date to a FHIR date query string for the "from" date.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dateFrom | string | Optional start date |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | FHIR date query string for "from" date |

### `isoDateToFHIRDateQueryTo`
#### Description
Converts an ISO date to a FHIR date query string for the "to" date.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dateTo | string | Optional end date |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | FHIR date query string for "to" date |

### `resourceSupportsDateQuery`
#### Description
Checks if a given resource type supports date queries.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| resourceType | MedplumResourceType | The resource type to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if the resource supports date queries, false otherwise |

### `isResourceDerivedFromDocRef`
#### Description
Checks if a resource is derived from a specific DocumentReference.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| resource | Resource | The resource to check |
| docId | string | The DocumentReference ID |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if the resource is derived from the specified DocumentReference, false otherwise |

### `isExtensionDerivedFromDocRef`
#### Description
Checks if an extension is derived from a specific DocumentReference.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| e | Extension | The extension to check |
| docId | string | The DocumentReference ID |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| boolean | boolean | True if the extension is derived from the specified DocumentReference, false otherwise |

### `getIdFromSubjectId`
#### Description
Extracts the ID from a subject's ID reference.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| subject | Reference | The subject reference |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | The extracted ID, or undefined if not found |

### `getIdFromSubjectRef`
#### Description
Extracts the ID from a subject's reference string.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| subject | Reference | The subject reference |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | string | The extracted ID, or undefined if not found |

The file also includes several type-checking functions (e.g., `isLocation`, `isPatient`, etc.) and resource finder functions (e.g., `findOrganizationResource`, `findCompositionResource`, etc.) which follow a similar pattern.

## Dependencies
The code relies on several external libraries and modules, including `@medplum/core`, `@medplum/fhirtypes`, and custom modules for handling extensions and other FHIR-related functionality.

This documentation provides an overview of the main functions and their purposes. For more detailed information about specific functions or usage, refer to the inline comments and type definitions in the code.