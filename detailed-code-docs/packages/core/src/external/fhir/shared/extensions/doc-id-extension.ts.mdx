---
title: "doc-id-extension.ts"
---

## High-level description
This code defines a FHIR extension for document IDs and provides a function to build this extension. It's part of a larger system that handles FHIR (Fast Healthcare Interoperability Resources) data, specifically for managing document references.

## Symbols

### `DOC_ID_EXTENSION_URL`
#### Description
A constant string that represents the URL for the document ID extension. It's constructed by appending "/doc-id-extension.json" to the `BASE_EXTENSION_URL`.

#### Inputs
None

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| DOC_ID_EXTENSION_URL | string | The complete URL for the document ID extension |

### `DocIdExtension`
#### Description
A type definition for the document ID extension. It's a subset of the FHIR Extension type, requiring the `url` and `valueString` properties.

#### Inputs
None (it's a type definition)

#### Outputs
None (it's a type definition)

### `buildDocIdFhirExtension`
#### Description
A function that creates a DocIdExtension object with the given document ID.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| docId | string | The document ID to be included in the extension |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| DocIdExtension | object | An object conforming to the DocIdExtension type |

#### Internal Logic
1. Creates an object with two properties:
   - `url`: Set to the `DOC_ID_EXTENSION_URL` constant
   - `valueString`: Set to the provided `docId`
2. Returns this object, which conforms to the DocIdExtension type

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @medplum/fhirtypes | Provides the Extension type used in the code |
| ./base-extension | Provides the BASE_EXTENSION_URL constant |

## TODOs
There is a TODO comment (TODO #712) indicating that this extension needs to be created.

## References
This code is referenced and used in other parts of the system, particularly:
1. In the FHIR converter (`packages/api/src/external/fhir-converter/converter.ts`) to add document reference extensions to resources.
2. In the bundle hydration process (`packages/api/src/external/fhir/shared/hydrate-bundle.ts`) to add document extensions to resources in a FHIR bundle.

These references suggest that the document ID extension is used to track the origin of FHIR resources, linking them back to their source documents.