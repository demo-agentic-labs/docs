---
title: "allergy-intolerance.ts"
---

## High-level description
This code defines a function `makeAllergyIntollerance` that creates a FHIR AllergyIntolerance resource for a given patient. It's designed to generate a standardized allergy intolerance record with predefined values, which can be used for testing or as a template for creating allergy intolerance records.

## Symbols

### `makeAllergyIntollerance`
#### Description
This function creates and returns an AllergyIntolerance resource object based on the FHIR standard. It uses a predefined structure with some fixed values and incorporates the provided patient information.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| patient | PatientWithId | An object representing a patient, which must include an `id` property |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value) | AllergyIntolerance | A FHIR AllergyIntolerance resource object |

#### Internal Logic
1. Creates an AllergyIntolerance object with the following key components:
   - Assigns a new UUID using `uuidv7()`
   - Sets the meta profile to US Core AllergyIntolerance
   - Defines clinical status as "active"
   - Sets verification status as "confirmed"
   - Specifies type as "allergy"
   - Sets category to "environment"
   - Defines criticality as "low"
   - Includes a reaction with manifestation and substance
   - Sets the allergy code
   - Links the allergy to the provided patient
   - Sets a fixed recorded date

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @medplum/fhirtypes | Provides TypeScript types for FHIR resources |
| ../../../util/uuid-v7 | Generates UUIDs for the resource |
| ./patient | Likely provides the PatientWithId type |

## References
This code references:
- The FHIR AllergyIntolerance resource structure
- US Core profile for AllergyIntolerance
- SNOMED CT codes for allergy manifestation and type

## Notes
- The function creates a very specific type of allergy (environmental, low criticality, skin eruption reaction to pollen) which may not be suitable for all use cases.
- The recorded date is hardcoded, which might not be ideal for real-world scenarios.
- This function is likely used for testing or as a template for creating allergy records in a standardized way.