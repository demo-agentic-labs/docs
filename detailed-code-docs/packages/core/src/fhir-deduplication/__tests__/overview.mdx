---
title: "Overview"
---

## High-level description
This directory contains unit tests for the FHIR deduplication functionality in the core package. The tests cover various aspects of grouping and deduplicating different FHIR resources such as conditions, allergies, immunizations, medications, observations, and procedures.

## What does it do?
The tests in this directory verify the correct behavior of functions responsible for:

1. Grouping and deduplicating FHIR resources based on specific criteria (e.g., codes, dates, names, addresses).
2. Handling edge cases and special scenarios in the deduplication process.
3. Ensuring that the deduplication logic preserves important information while removing redundancies.
4. Verifying the correct selection of the most descriptive status for resources like medication statements.

These tests help ensure that the FHIR deduplication process works as expected across various resource types and scenarios, maintaining data integrity and accuracy.

## Key Files

1. `combine-two-conditions.test.ts`: Tests the `combineTwoResources` function for merging two FHIR Condition resources.

2. `deduplicate-fhir.test.ts`: Tests the `deduplicateFhir` function for deduplicating FHIR resources in a bundle, focusing on medication-related resources.

3. `group-same-allergies.test.ts`: Tests the `extractFromReactions` and `groupSameAllergies` functions for handling allergy manifestations and grouping similar allergies.

4. `group-same-conditions.test.ts`: Tests the `groupSameConditions` function for grouping and deduplicating FHIR Condition resources.

5. `group-same-diag-reports.test.ts`: Tests the `groupSameDiagnosticReports` function for grouping duplicate diagnostic reports.

6. `group-same-encounters.test.ts`: Tests the `groupSameEncounters` function for grouping and deduplicating encounter resources.

7. `group-same-family-histories.test.ts`: Tests the `groupSameFamilyMemberHistories` function for grouping family member histories.

8. `group-same-immunizations.test.ts`: Tests the `groupSameImmunizations` function for grouping duplicate immunizations based on CVX codes and dates.

9. `group-same-locations.test.ts`: Tests the `groupSameLocations` function for grouping duplicate locations based on names and addresses.

10. `group-same-med-request.test.ts`: Tests the `groupSameMedRequests` function for grouping duplicate medication requests.

11. `group-same-med-statements.test.ts`: Tests the `groupSameMedStatements` function for grouping and deduplicating medication statements.

12. `group-same-medications.test.ts`: Tests the `groupSameMedications` function for grouping duplicate medications based on RxNorm, NDC, or SNOMED codes.

13. `group-same-observations.test.ts`: Tests the `groupSameObservationsSocial` and `groupSameObservations` functions for grouping and deduplicating FHIR Observation resources.

14. `group-same-organizations.test.ts`: Tests the `groupSameOrganizations` function for grouping and deduplicating organizations based on names and addresses.

15. `group-same-practitioners.test.ts`: Tests the `groupSamePractitioners` function for grouping and deduplicating practitioner records.

16. `group-same-procedures.test.ts`: Tests the `groupSameProcedures` function for grouping and deduplicating medical procedures.

17. `pick-most-descriptive-status.test.ts`: Tests the `pickMostDescriptiveStatus` function for selecting the more descriptive status between two given medication statement statuses.

## Dependencies
The main dependencies used across these test files are:

1. Jest: The testing framework used for writing and running the unit tests.
2. @faker-js/faker: Used to generate random data for testing purposes, such as UUIDs.
3. @medplum/fhirtypes: Provides TypeScript types for FHIR resources.
4. Various utility functions and example data from other parts of the codebase, such as `makeCondition`, `makeEncounter`, `makeMedication`, etc.

These tests are crucial for ensuring the reliability and correctness of the FHIR deduplication process implemented in the core package. They cover a wide range of scenarios and edge cases, helping to maintain the integrity of the healthcare data being processed.