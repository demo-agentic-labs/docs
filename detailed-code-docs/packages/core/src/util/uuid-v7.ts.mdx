---
title: "uuid-v7.ts"
---

## High-level description
This file contains utility functions for generating and validating UUID version 7 (UUIDv7) identifiers. It also includes functions for generating UUIDv4 identifiers and validating UUID strings against a regular expression pattern.

## Code Structure
The main symbols in this code are:
- `UUID` class: Represents a UUID as a 16-byte byte array.
- `V7Generator` class: Encapsulates the monotonic counter state for generating UUIDv7s.
- Utility functions: `uuidv7()`, `uuidv4()`, and `isValidUuid()`.

These symbols are interconnected, with the `V7Generator` using the `UUID` class to create UUIDv7s, and the utility functions using both classes to provide easy-to-use interfaces for generating and validating UUIDs.

## Symbols

### UUID
#### Description
Represents a UUID as a 16-byte byte array and provides methods for creation, manipulation, and comparison of UUIDs.

#### Internal Logic
- Uses a private constructor to create UUID instances
- Provides static methods for creating UUIDs from various inputs
- Implements methods for comparing, cloning, and converting UUIDs to strings

### V7Generator
#### Description
Encapsulates the monotonic counter state for generating UUIDv7s, ensuring that generated UUIDs are monotonically increasing.

#### Internal Logic
- Maintains a timestamp and counter state
- Provides methods to generate new UUIDs or abort if a significant clock rollback is detected
- Uses a random number generator for additional entropy

### uuidv7()
#### Description
Generates a UUIDv7 string using the default generator.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| output | string | The 8-4-4-4-12 canonical hexadecimal string representation of a UUIDv7 |

### uuidv4()
#### Description
Generates a UUIDv4 string.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| output | string | The 8-4-4-4-12 canonical hexadecimal string representation of a UUIDv4 |

### isValidUuid()
#### Description
Checks if a string matches the UUID regex pattern.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| uuid | string | Any string to be validated as a UUID |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| output | boolean | True if the input string is a valid UUID, false otherwise |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| crypto | Used for generating random values |

## Error Handling
The code uses standard JavaScript error throwing for invalid inputs or states, such as when creating a UUID with an invalid byte array length.

## Performance Considerations
The code includes optimizations for UUID generation, such as buffering random values to improve performance when generating multiple UUIDs in succession.