---
title: "Overview"
---

## High-level description
This directory contains utility functions and modules for the Metriport core package. It provides a wide range of helper functions and tools for various tasks such as handling base64 encoding/decoding, managing concurrency, working with environment variables, file downloading, logging, XML processing, and UUID generation.

## What does it do?
The utility functions in this directory serve various purposes:

1. Base64 encoding and decoding: Provides functions to convert between base64-encoded strings and regular strings or buffers.

2. Concurrency management: Offers tools for executing asynchronous operations concurrently with configurable parallelism and error handling.

3. Environment variable handling: Includes functions to safely retrieve and manage environment variables.

4. File downloading: Provides utilities for downloading files using different methods (stream, memory, direct to file).

5. Logging: Offers flexible logging utilities with customizable prefixes and suffixes.

6. XML processing: Includes simple functions for generating XML-style opening and closing tags.

7. UUID generation and validation: Provides functions for generating UUID version 4 and version 7, as well as validating UUID strings.

8. Error handling and notifications: Offers utilities for capturing errors and sending notifications.

9. Database connection management: Includes functions for initializing and managing database pools using Sequelize.

10. MIME type handling: Provides utilities for working with MIME types and file extensions.

These utilities form a foundation for common tasks and operations throughout the Metriport application, promoting code reuse and consistency.

## Key Files

1. `base64.ts`: Functions for base64 encoding and decoding.
2. `concurrency.ts`: Utilities for managing asynchronous operations and concurrency.
3. `env-var.ts`: Functions for handling environment variables.
4. `file-downloader.ts`: Utilities for downloading files using various methods.
5. `log.ts`: Flexible logging utilities.
6. `uuid-v7.ts`: Functions for generating and validating UUIDs.
7. `xml.ts`: Simple utilities for generating XML-style tags.
8. `error/`: Directory containing error handling utilities and custom error classes.
9. `sequelize.ts`: Functions for initializing and managing database connections using Sequelize.
10. `mime.ts`: Utilities for working with MIME types and file extensions.

## Dependencies
The utility functions in this directory rely on several external libraries and Node.js built-in modules:

1. `axios`: Used for HTTP requests in file downloading.
2. `sequelize`: ORM for database operations.
3. `zod`: Runtime type checking and schema declaration.
4. `@sentry/node`: For error capturing and monitoring.
5. `mime-types`: Used for MIME type and file extension operations.
6. Node.js built-in modules: `crypto`, `fs`, `stream`, `util`, and `async_hooks`.

## Configuration
Many of the utility functions are designed to be flexible and accept configuration options. For example, the concurrency utilities allow for configurable parallelism and error handling, while the logging utilities accept custom prefixes and suffixes.

Some utilities, particularly those dealing with environment variables and database connections, may rely on specific environment variables or configuration files set up elsewhere in the application.

## Notes
1. Several functions and modules are marked as deprecated, suggesting that they may be replaced or moved to a shared package in the future. Users of these utilities should be aware of potential upcoming changes.

2. The error handling utilities provide a standardized way to capture and report errors throughout the application, which can be valuable for debugging and monitoring.

3. The concurrency and file downloading utilities offer powerful tools for managing asynchronous operations and handling large-scale data processing tasks.

4. The UUID generation functions include support for both version 4 and version 7 UUIDs, with the latter providing additional features like monotonic ordering.

5. The database connection utilities provide a type-safe and flexible way to manage Sequelize database pools, including support for read-only replicas.

Overall, this utilities directory serves as a central repository of helper functions and tools that can be used across the Metriport application to simplify common tasks and promote code consistency.