---
title: "Overview"
---

## High-level description
This directory contains utility scripts for testing and populating document query progress functionality in the Metriport Medical API. The scripts are designed to create patients, upload documents, test conversion load, and validate document query progress. These tools are primarily used for testing, demonstration, and load testing purposes.

## What does it do?
The scripts in this directory perform several key functions:

1. Create a set of fictional patients based on superhero characters for testing purposes.
2. Populate patient records with various types of medical documents (XML, PDF, JPEG).
3. Test the load on the conversion status endpoint of the medical API.
4. Validate the document query progress functionality for a set of patients.

These scripts simulate real-world scenarios of patient data management, document uploading, and querying in a medical records system. They help ensure that the Metriport Medical API can handle various operations related to patient documents efficiently and accurately.

## Entry points
The main entry points for this directory are:

1. `populate-patient-docs.ts`: Creates patients and uploads documents for testing.
2. `test-conversion-load.ts`: Tests the load on the conversion status endpoint.
3. `validate-doc-query-progress.ts`: Validates the document query progress functionality.

The data flow typically starts with creating patients (using data from `patients.ts`), then moves to uploading documents or testing query progress. The control flow is managed within each script's `main()` function, which orchestrates the various operations.

## Key Files

1. `patients.ts`: Defines a list of fictional patients used for testing.
2. `populate-patient-docs.ts`: Creates patients and uploads various document types.
3. `test-conversion-load.ts`: Simulates high load on the conversion status endpoint.
4. `validate-doc-query-progress.ts`: Tests the document query progress functionality.

Each file plays a crucial role in testing different aspects of the document query and management system:

- `patients.ts` provides consistent test data across all scripts.
- `populate-patient-docs.ts` sets up the test environment with patient data and documents.
- `test-conversion-load.ts` ensures the API can handle multiple concurrent requests.
- `validate-doc-query-progress.ts` verifies the accuracy and functionality of the document query process.

## Dependencies
The scripts in this directory rely on several external libraries and internal modules:

1. @metriport/api-sdk: Used for interacting with the Metriport Medical API.
2. @metriport/core: Provides utility functions and type definitions.
3. @metriport/shared: Offers shared utilities and constants.
4. axios: Used for making HTTP requests.
5. dotenv: Loads environment variables for configuration.
6. dayjs: Handles date and time operations.
7. @faker-js/faker: Generates fake data for testing purposes.

These dependencies were chosen to provide robust API interaction, efficient HTTP requests, and helpful utilities for testing and data manipulation.

## Configuration
The scripts use environment variables for configuration, typically loaded using dotenv. Key configuration options include:

1. API_KEY: The Metriport API key for authentication.
2. API_URL: The base URL for the Metriport API.
3. FACILITY_ID: The ID of the facility used for patient creation.
4. CX_ID: The customer ID.
5. NUM_XML, NUM_PDF, NUM_JPEG: The number of each document type to upload per patient.
6. NUM_OF_REQUESTS: The number of conversion status requests to send in load testing.

These configuration options allow for flexible testing scenarios and easy adaptation to different environments or requirements.

Example usage of configuration in `populate-patient-docs.ts`:

```typescript
const API_KEY = getEnvVar("API_KEY");
const API_URL = getEnvVar("API_URL");
const FACILITY_ID = getEnvVar("FACILITY_ID");
const NUM_XML = Number(getEnvVar("NUM_XML", "300"));
const NUM_PDF = Number(getEnvVar("NUM_PDF", "100"));
const NUM_JPEG = Number(getEnvVar("NUM_JPEG", "100"));
```

This configuration setup allows for easy modification of test parameters and API endpoints without changing the code.

In conclusion, this directory provides a comprehensive set of tools for testing and validating the document query and management functionality of the Metriport Medical API. The scripts cover various aspects from patient creation and document uploading to load testing and progress validation, ensuring robust and reliable API performance.