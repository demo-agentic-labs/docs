---
title: "Overview"
---

## High-level description
This directory contains utility scripts and functions related to Carequality integration in the Metriport medical API. It includes tools for certificate testing, end-to-end validation of the Carequality workflow, and retrieval of Cross-Community Patient Discovery (XCPD) statistics.

## What does it do?
The code in this directory performs several key functions:

1. Certificate Testing: It sets up an HTTPS server to test certificates issued by Carequality, ensuring secure communication.

2. End-to-End Validation: It simulates the entire Carequality workflow, including creating a test patient, performing document queries and retrievals, and verifying the results. This helps in validating the integration of Carequality with the Metriport medical API.

3. XCPD Statistics: It retrieves and logs Cross-Community Patient Discovery statistics for specific patients, providing insights into the patient discovery process across different communities.

These utilities are crucial for testing, validating, and monitoring the Carequality integration, ensuring that patient data exchange functions correctly and securely.

## Key Files

1. `cq-cert-checker.ts`:
   This file sets up an HTTPS server using Express.js to test Carequality-issued certificates. It reads SSL/TLS credentials from files and creates a secure server listening on port 3000. This is essential for verifying the correct configuration and functionality of Carequality certificates.

2. `e2e-validation.ts`:
   This script performs an end-to-end validation of the Carequality integration. It simulates the entire workflow, including:
   - Creating a test patient
   - Waiting for patient data population
   - Initiating document queries
   - Polling for query results
   - Initiating document retrieval
   - Polling for retrieval results
   - Checking final query status
   - Deleting the test patient
   This comprehensive test ensures that all components of the Carequality integration are functioning correctly.

3. `patient-discovery-statistics.ts`:
   This script retrieves and logs Cross-Community Patient Discovery (XCPD) statistics for a specific patient. It uses environment variables for configuration and calls an external function to fetch the statistics. This tool is useful for monitoring and analyzing the effectiveness of patient discovery processes across different healthcare communities.

## Dependencies
The code in this directory relies on several external libraries and frameworks:

1. Express.js (version not specified): Used for creating the HTTPS server in the certificate checker.
2. Node.js built-in modules (https, fs): Used for HTTPS server creation and file system operations.
3. dotenv (version not specified): Used to load environment variables from a .env file.
4. @metriport/core (version not specified): Provides utility functions.
5. @metriport/api-sdk (version not specified): Client for interacting with the Metriport Medical API.
6. Sequelize (version not specified): ORM for database operations.
7. @metriport/shared (version not specified): Additional utility functions.
8. dayjs (version not specified): Used for date manipulation.
9. axios (version not specified): HTTP client for making API requests.

These dependencies were chosen to provide a robust set of tools for server creation, API interaction, database operations, and utility functions necessary for Carequality integration and testing.

## Configuration
The scripts in this directory use various configuration options, primarily set through environment variables:

1. API_URL: The URL of the Metriport API.
2. API_KEY: The API key for authentication with the Metriport API.
3. DB_CREDS: JSON string containing database credentials.
4. CX_ID: The customer ID.

Additionally, the certificate checker script requires paths to SSL/TLS credential files:
- Path to private key file
- Path to certificate chain file

These configuration options allow for flexible deployment and testing across different environments while maintaining security through the use of environment variables for sensitive information.