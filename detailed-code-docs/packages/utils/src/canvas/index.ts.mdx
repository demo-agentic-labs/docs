---
title: "index.ts"
---

## High-level description
This code is a script that interacts with the Canvas Medical API to create and populate a medical note for a patient. It uses the CanvasSDK to authenticate, create a note, and add various medical records such as conditions, medications, and allergies to the note.

## Code Structure
The main function `main()` initializes the CanvasSDK with environment variables and calls the `createFullNote()` function to create and populate a medical note for a specific patient.

## References
This code references the following external modules and functions:
- `@metriport/core/external/canvas/index`: CanvasSDK
- `@metriport/core/external/canvas/note`: createFullNote
- `@metriport/core/util/env-var`: getEnvVarOrFail

## Symbols

### main
#### Description
The main function that initializes the CanvasSDK and creates a full note for a patient.

#### Internal Logic
1. Initializes the CanvasSDK with environment variables.
2. Calls `createFullNote()` with specific parameters to create and populate a medical note.
3. Catches and logs any errors that occur during the process.

### createFullNote (imported function)
#### Description
Creates a full medical note for a patient, including allergies, conditions, and medications.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| canvas | CanvasSDK | Instance of the CanvasSDK |
| canvasPatientId | string | ID of the patient in Canvas |
| patientA | boolean | Flag to indicate if it's patient A (female) |
| patientB | boolean | Flag to indicate if it's patient B (male) |
| providerLastName | string | Last name of the healthcare provider |

#### Internal Logic
1. Retrieves practitioner and location information from Canvas.
2. Creates a new note in Canvas.
3. Generates fake patient data based on the patient type (A or B).
4. Adds allergies, conditions, and medications to the note using Canvas API.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dotenv | Load environment variables |
| @metriport/core/external/canvas/index | CanvasSDK for interacting with Canvas API |
| @metriport/core/external/canvas/note | Function to create a full note |
| @metriport/core/util/env-var | Utility to get environment variables |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| CANVAS_CLIENT_SECRET | string | N/A | Canvas API client secret |
| CANVAS_CLIENT_ID | string | N/A | Canvas API client ID |

## Error Handling
The main function is wrapped in a try-catch block to catch and log any errors that occur during execution.

## TODOs
There is a commented-out code block for getting an appointment, which might be implemented in the future:
```typescript
// const appointment = await canvas.getAppointment("01910eff-0758-700e-bc2a-26a3a35e0b68");
// console.log(JSON.stringify(appointment, null, 2));
```

There's also a commented-out call to `createFullNote()` with different parameters:
```typescript
// await createFullNote({ canvas, canvasPatientId, patientA: false, patientB: true });
// console.log("note created");
```

These TODOs suggest that there might be plans to extend the functionality of this script in the future.