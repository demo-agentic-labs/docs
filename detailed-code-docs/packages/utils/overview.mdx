---
title: "Overview"
---

## High-level description
The `packages/utils` directory contains a collection of utility scripts and functions designed to support various aspects of the Metriport medical API. This package provides tools for patient management, data conversion, file handling, API interactions, and testing utilities, specifically tailored for healthcare data processing and interoperability.

## What does it do?
The utils package performs a wide range of functions related to healthcare data management and processing:

1. Patient data management: It provides tools for creating, updating, and querying patient information.
2. Data conversion: The package includes utilities for converting between different healthcare data formats, such as FHIR, CDA, and XML.
3. File operations: It handles file uploads, downloads, and conversions, particularly with AWS S3.
4. API interactions: The package facilitates making requests to various healthcare-related APIs and processing responses.
5. Testing and simulation: It offers mock implementations and test utilities for healthcare interoperability processes.
6. Data analysis: The package includes tools for analyzing and processing healthcare data, including patient demographics and medical records.
7. Queue management: It provides functionality for working with Amazon SQS, including handling Dead Letter Queues.
8. Search operations: The package interacts with OpenSearch for indexing and querying healthcare data.

These utilities are designed to support various aspects of healthcare data management, interoperability, and analysis within the Metriport ecosystem.

## Key Files
1. `src/patient/index.ts`: Contains functions for retrieving patient IDs.
2. `src/fhir-converter/convert.ts`: Handles conversion of healthcare data formats.
3. `src/document/document-upload.ts`: Manages document upload processes.
4. `src/commonwell/session-manager.ts`: Handles session management for CommonWell interactions.
5. `src/open-search/cleanup.ts`: Provides utilities for cleaning up XML/CDA files.
6. `src/sqs/populate-sqs.ts`: Handles populating SQS queues with messages.

## Dependencies
The package relies on several external libraries and services:

1. AWS SDK: For interacting with AWS services like S3 and SQS.
2. Axios: For making HTTP requests.
3. Express: For creating mock servers in testing scenarios.
4. Medplum FHIR types: For FHIR data structure definitions.
5. OpenSearch: For search and analytics functionality.
6. Sequelize: For database operations.
7. Various Metriport internal packages: For core functionalities and shared utilities.

## Configuration
The package uses a combination of TypeScript configuration files and package.json for setup:

1. `tsconfig.json`: Configures TypeScript compilation options, including output directory and module resolution.
2. `tsconfig.ref.json`: Sets up TypeScript's project references feature for use in a multi-package project.
3. `package.json`: Defines scripts, dependencies, and development tools for the package.

Configuration for runtime behavior is primarily managed through environment variables and command-line arguments. Common configurable aspects include:

1. API endpoints and keys
2. AWS credentials and region settings
3. Database connection details
4. File paths for input/output operations
5. Operational parameters like batch sizes and delay times

Many scripts use dotenv for loading environment variables, allowing for flexible configuration across different environments.

The package also includes an ESLint configuration file (`.eslintrc.js`) that sets up linting rules for TypeScript, integrating with Prettier for code formatting.

In conclusion, the `packages/utils` directory provides a comprehensive set of tools for working with healthcare data in the Metriport ecosystem. It covers a wide range of functionalities from basic file operations to complex healthcare data processing and interoperability tasks. The utilities are designed to be flexible and configurable, supporting various use cases in healthcare data management and analysis.