---
title: "patient-management.ts"
---

## High-level description
This code implements patient management functionality for the CommonWell Health Alliance certification process. It includes operations such as registering a new patient, updating patient demographics, searching for patients, merging patient records, and managing patient links.

## Code Structure
The main function `patientManagement` orchestrates various patient-related operations using the CommonWell SDK. It interacts with utility functions from `util.ts` and payload creation functions from `payloads.ts`.

## Symbols

### `patientManagement`
#### Description
This async function performs a series of patient management operations as part of the CommonWell certification process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| commonWell | CommonWell | The main CommonWell SDK instance |
| commonwellSandbox | CommonWell | A CommonWell SDK instance for sandbox operations |
| queryMeta | RequestMetadata | Metadata for the API requests |

#### Internal Logic
1. Registers a new patient
2. Updates patient demographics
3. Searches for a patient
4. Merges two patient records
5. Retrieves network links
6. Upgrades and downgrades network links
7. Cleans up by deleting created patients and person

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @metriport/commonwell-sdk | Provides the CommonWell SDK functionality |
| lodash | Used for deep cloning objects |

## Error Handling
The code uses try-catch blocks and throws errors with descriptive messages when certain operations fail or expected data is missing.

## TODOs
There are no explicit TODOs in the code.