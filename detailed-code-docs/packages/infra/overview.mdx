---
title: "Overview"
---

## High-level description
The "packages/infra" directory contains the infrastructure-as-code (IaC) implementation for the Metriport project using AWS CDK with TypeScript. This directory includes configuration files, deployment scripts, and infrastructure stack definitions for various AWS services and resources.

## What does it do?
This infrastructure code accomplishes the following:

1. Defines and deploys AWS resources for different environments (sandbox, staging, production) using AWS CDK.
2. Sets up various AWS services including ECS, RDS, OpenSearch, Lambda, API Gateway, and SQS.
3. Configures monitoring and alerting using CloudWatch dashboards and alarms.
4. Implements security measures such as WAF rules and secret management.
5. Provides utilities for environment-specific configurations and shared constructs.
6. Enables IHE (Integrating the Healthcare Enterprise) Gateway setup and configuration.
7. Manages certificates for secure communications.

## Entry points
The main entry point for the CDK application is `bin/infrastructure.ts`. This file orchestrates the deployment of various stacks based on the environment configuration.

Key files and directories include:
- `bin/`: Contains the main CDK application entry point.
- `lib/`: Houses shared utilities, constructs, and configurations for AWS services.
- `config/`: Stores environment-specific configurations and type definitions.
- `dashboards/`: Contains JSON configurations for CloudWatch dashboards.

## Dependencies
The project relies on several key dependencies:

1. AWS CDK Library (`aws-cdk-lib`): Core library for defining cloud infrastructure.
2. Constructs: Library for defining cloud components.
3. TypeScript: The primary programming language used.
4. Jest: For testing the infrastructure code.
5. ESLint and Prettier: For code linting and formatting.

## Configuration
The project uses a flexible configuration system defined in the `config/` directory. Key configuration areas include:

1. Environment settings (sandbox, staging, production)
2. AWS service configurations (ECS, RDS, OpenSearch)
3. API and database settings
4. Authentication and security configurations
5. Third-party service integrations
6. S3 bucket configurations
7. Secret management

The `cdk.json` file provides context and settings for the CDK application, including build commands and AWS service-specific configurations.

## Error Handling
Error handling is implemented throughout the codebase, particularly in shared utilities and constructs. This includes checks for required configuration properties and appropriate error throwing when necessary.

In conclusion, the "packages/infra" directory provides a comprehensive and flexible infrastructure-as-code solution for deploying and managing AWS resources for the Metriport project across different environments. It emphasizes reusability, configurability, and best practices in cloud infrastructure management.