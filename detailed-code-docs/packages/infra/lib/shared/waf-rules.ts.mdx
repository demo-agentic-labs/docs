---
title: "waf-rules.ts"
---

## High-level description
This code defines a set of AWS WAF (Web Application Firewall) rules for protecting web applications. It exports an array of rule properties that can be used to configure a WAF WebACL (Web Access Control List).

## Code Structure
The code exports a single constant `wafRules` which is an array of `wafv2.CfnWebACL.RuleProperty` objects. Each object in the array represents a specific WAF rule with its configuration.

## Symbols

### `wafRules`
#### Description
An array of WAF rule properties that define various security rules for web application protection.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| wafRules | wafv2.CfnWebACL.RuleProperty[] | An array of WAF rule properties |

#### Internal Logic
The `wafRules` array contains multiple rule objects, each representing a specific AWS Managed Rule Group or custom rule. Each rule has properties such as name, priority, statement, overrideAction, and visibilityConfig. The rules are ordered by priority and cover various security aspects like IP reputation, anonymous IP protection, common vulnerabilities, and specific attack patterns.

## Rule Descriptions

1. AWS-AWSManagedRulesAmazonIpReputationList: Blocks requests from IP addresses on AWS's reputation list of known malicious actors/bots.

2. AWS-AWSManagedRulesAnonymousIpList: Blocks requests from services that obfuscate viewer identity (e.g., VPNs, proxies, Tor nodes). It excludes web hosting providers.

3. AWS-AWSManagedRulesCommonRuleSet: Implements a common rule set aligned with major portions of the OWASP Core Rule Set. It excludes certain rules to allow specific functionalities.

4. AWS-AWSManagedRulesAdminProtectionRuleSet: Blocks external access to exposed administrative pages.

5. AWS-AWSManagedRulesKnownBadInputsRuleSet: Blocks request patterns associated with exploitation or vulnerability discovery.

6. AWS-AWSManagedRulesSQLiRuleSet: Blocks common SQL Injection attempts.

7. AWS-AWSManagedRulesLinuxRuleSet: Blocks attacks targeting Local File Injection (LFI) for Linux systems.

8. AWS-AWSManagedRulesUnixRuleSet: Blocks request patterns associated with vulnerabilities specific to POSIX and POSIX-like operating systems.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| aws-cdk-lib | Provides the `aws_wafv2` construct for defining WAF rules |

Note: This code is designed to be used as part of a larger AWS CDK (Cloud Development Kit) application for configuring WAF protection for web applications.