---
title: "Overview"
---

## High-level description
This directory contains the infrastructure code for an API stack, likely part of a larger application. It includes various components such as API services, database maintenance, document processing, FHIR (Fast Healthcare Interoperability Resources) conversion, and integration with external services like CommonWell and Carequality. The code is written using AWS CDK (Cloud Development Kit) to define and provision AWS resources.

## What does it do?
This API stack infrastructure code sets up a comprehensive backend system for handling healthcare-related data and operations. It includes:

1. Setting up an API service using AWS ECS Fargate
2. Configuring database maintenance tasks
3. Managing document uploads and processing
4. Implementing FHIR conversion and integration
5. Setting up connections to external healthcare networks (CommonWell, Carequality)
6. Configuring alarms and monitoring
7. Implementing scheduled tasks for various maintenance and update operations

The infrastructure is designed to be scalable, secure, and compliant with healthcare data handling requirements.

## Entry points
The main entry point for this API stack is likely the `api-service.ts` file, which sets up the core API service using AWS ECS Fargate. Other key files include:

- `fhir-converter-service.ts`: Sets up the FHIR conversion service
- `fhir-server-connector.ts`: Connects the API to a FHIR server
- `document-upload.ts`: Handles document upload functionality
- `cw-enhanced-coverage-connector.ts`: Manages CommonWell enhanced coverage functionality

The infrastructure is designed to work together, with various components interacting through AWS services like SQS, Lambda, and S3.

## Key Files
1. `api-service.ts`: Sets up the main API service using ECS Fargate
2. `fhir-converter-service.ts`: Configures the FHIR conversion service
3. `fhir-server-connector.ts`: Establishes connection to a FHIR server
4. `document-upload.ts`: Manages document upload functionality
5. `cw-enhanced-coverage-connector.ts`: Handles CommonWell enhanced coverage
6. `db-maintenance.ts`: Sets up database maintenance tasks
7. `alarm-slack-chatbot.ts`: Configures Slack notifications for alarms
8. `ccda-search-connector.ts`: Sets up CCDA document search functionality

## Dependencies
The code relies heavily on AWS CDK and various AWS services. Key dependencies include:

- aws-cdk-lib: Core library for AWS CDK
- constructs: For creating custom CDK constructs
- @metriport/core: Likely an internal library for core functionality
- Various AWS services: ECS, ECR, Lambda, SQS, S3, CloudWatch, IAM, etc.

## Configuration
The infrastructure is highly configurable, with many settings determined by environment variables and configuration files. Key configuration areas include:

- Environment-specific settings (production vs. non-production)
- Scaling parameters for ECS tasks and Lambda functions
- Timeouts and memory allocations for various components
- Integration endpoints for external services
- Alarm thresholds and notification settings

Configuration is typically handled through a combination of environment variables, CDK context values, and imported configuration modules.

## Error Handling
Error handling is implemented through various mechanisms:

- CloudWatch alarms for monitoring service health and performance
- Dead-letter queues for handling failed SQS messages
- Retry mechanisms for Lambda functions
- Slack notifications for critical alarms

The infrastructure is designed to be resilient, with multiple layers of error detection and handling to ensure system stability and reliability.