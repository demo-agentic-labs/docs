---
title: "Overview"
---

## High-level description
This directory contains test files for the IHE Gateway SDK. It includes constant definitions for test data, environment setup for testing, and unit tests for inbound and outbound request schema validations. The tests cover Patient Discovery, Document Query, and Document Retrieval operations, which are key components of healthcare interoperability.

## What does it do?
The test suite in this directory performs several important functions:

1. It defines constant test objects that represent different types of inbound messages used in healthcare interoperability, such as Cross-Community Patient Discovery (XCPD), Document Query (DQ), and Document Retrieve (DR).

2. It sets up the testing environment by loading environment variables from a `.env.test` file, ensuring that the tests run with the correct configuration regardless of the current working directory.

3. It validates the schemas for inbound and outbound requests for Patient Discovery, Document Query, and Document Retrieval operations. These tests ensure that the defined schemas correctly validate the expected request structures for both inbound and outbound scenarios.

The tests check that valid requests pass the appropriate schema validations and that invalid requests fail as expected. This helps ensure the robustness and reliability of the IHE Gateway SDK in handling various types of healthcare-related data exchanges.

## Key Files

1. `constants.ts`:
   This file defines constant objects used for testing purposes. It includes:
   - `testInboundXCPD`: A test object for Cross-Community Patient Discovery messages.
   - `testInboundDQ`: A test object for Document Query messages.
   - `testInboundDR`: A test object for Document Retrieve messages.
   These objects contain realistic test data, including patient demographics, SAML attributes, and document references.

2. `env-setup.ts`:
   This file is responsible for setting up the testing environment. It uses the `dotenv` library to load environment variables from a `.env.test` file. The file is designed to work correctly whether run from the project root or the `packages/ihe-gateway-sdk` directory.

3. `ihe-inbound-lambdas.test.ts`:
   This is the main test file containing unit tests for validating inbound and outbound request schemas. It includes three main test suites:
   - Patient Discovery Request Validation
   - Document Query Request Validation
   - Document Retrieval Request Validation
   Each suite tests the validation of inbound requests, checks for failures with outbound schemas, and validates modified requests that should pass both inbound and outbound schemas.

## Dependencies
The test suite relies on the following external libraries:

1. `dotenv` (version not specified): Used in `env-setup.ts` to load environment variables from the `.env.test` file.
2. `zod` (version not specified): Used indirectly through imported schemas for object validation in the test files.
3. `@jest/globals` (version not specified): Provides the testing framework used in `ihe-inbound-lambdas.test.ts`.

These dependencies were likely chosen for their reliability and widespread use in the JavaScript/TypeScript ecosystem. `dotenv` is a standard for managing environment variables, `zod` is a popular schema validation library, and Jest is a well-established testing framework for JavaScript projects.

## Configuration
The test suite uses a `.env.test` file for configuration. This file is loaded by `env-setup.ts` and should contain environment-specific variables needed for testing. The exact contents of this file are not provided in the given code snippets, but it's likely to include settings such as API endpoints, test credentials, or other configuration parameters specific to the testing environment.

The `env-setup.ts` file is designed to locate and load the `.env.test` file correctly, regardless of whether the tests are run from the project root or the `packages/ihe-gateway-sdk` directory. This ensures consistent behavior across different development setups.

In conclusion, this test directory provides a comprehensive suite of tests and utilities to ensure the correct functioning of the IHE Gateway SDK, particularly in handling various types of healthcare interoperability messages and requests. The use of constant test objects, environment setup, and schema validations contributes to the robustness and reliability of the SDK.