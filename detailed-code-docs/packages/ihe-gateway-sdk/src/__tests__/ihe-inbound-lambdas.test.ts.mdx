---
title: "ihe-inbound-lambdas.test.ts"
---

## High-level description
This file contains unit tests for validating inbound and outbound request schemas for Patient Discovery, Document Query, and Document Retrieval operations in an IHE (Integrating the Healthcare Enterprise) gateway SDK. The tests ensure that the defined schemas correctly validate the expected request structures for both inbound and outbound scenarios.

## Code Structure
The test file is organized into three main describe blocks, each focusing on a specific operation: Patient Discovery, Document Query, and Document Retrieval. Within each block, there are tests for validating inbound requests, checking for failures with outbound schemas, and validating modified requests that should pass both inbound and outbound schemas.

## References
- `inboundPatientDiscoveryReqSchema`, `outboundPatientDiscoveryReqSchema` from "../models/patient-discovery/patient-discovery-requests"
- `inboundDocumentQueryReqSchema`, `outboundDocumentQueryReqSchema` from "../models/document-query/document-query-requests"
- `inboundDocumentRetrievalReqSchema`, `outboundDocumentRetrievalReqSchema` from "../models/document-retrieval/document-retrieval-requests"
- `testInboundXCPD`, `testInboundDQ`, `testInboundDR` from "./constants"

## Symbols

### `describe("Inbound Patient Discovery Request Validation", ...)`
#### Description
This test suite validates the Patient Discovery request schemas.

#### Internal Logic
1. Tests successful validation of `testInboundXCPD` with `inboundPatientDiscoveryReqSchema`
2. Tests failed validation of `testInboundXCPD` with `outboundPatientDiscoveryReqSchema`
3. Tests successful validation of a modified `testInboundXCPD` with both inbound and outbound schemas

### `describe("Inbound Document Query Request Validation", ...)`
#### Description
This test suite validates the Document Query request schemas.

#### Internal Logic
1. Tests successful validation of `testInboundDQ` with `inboundDocumentQueryReqSchema`
2. Tests failed validation of `testInboundDQ` with `outboundDocumentQueryReqSchema`
3. Tests successful validation of a modified `testInboundDQ` with both inbound and outbound schemas

### `describe("Inbound Document Retrieval Request Validation", ...)`
#### Description
This test suite validates the Document Retrieval request schemas.

#### Internal Logic
1. Tests successful validation of `testInboundDR` with `inboundDocumentRetrievalReqSchema`
2. Tests failed validation of `testInboundDR` with `outboundDocumentRetrievalReqSchema`
3. Tests successful validation of a modified `testInboundDR` with both inbound and outbound schemas

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @jest/globals | Provides testing framework (implied by the use of `describe`, `it`, and `expect`) |
| zod | Used indirectly through the imported schemas for object validation |

## Error Handling
The tests use Zod's `safeParse` method, which returns an object with a `success` property. This allows for graceful handling of validation failures without throwing exceptions.

## Performance Considerations
These tests are primarily focused on schema validation and are not likely to be performance-critical. However, for larger test suites or more complex schemas, consider the potential impact on test execution time.