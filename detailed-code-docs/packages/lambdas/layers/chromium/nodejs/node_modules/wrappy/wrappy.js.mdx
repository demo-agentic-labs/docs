---
title: "wrappy.js"
---

## High-level description
This code defines a function called `wrappy` that creates a wrapper function for callbacks. It ensures that the properties of the original function are retained in the wrapper, and it handles cases where the wrapped function returns another function.

## Symbols

### `wrappy`
#### Description
`wrappy` is the main function exported by this module. It creates a wrapper function that preserves the properties of the original function and handles nested callbacks.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fn | Function | The function to be wrapped |
| cb | Function | (Optional) A callback function |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| wrapper | Function | The wrapped function |

#### Internal Logic
1. If both `fn` and `cb` are provided, it recursively calls `wrappy(fn)(cb)`.
2. If `fn` is not a function, it throws a TypeError.
3. It copies all properties from `fn` to the `wrapper` function.
4. The `wrapper` function:
   - Creates an array of arguments.
   - Calls the original function `fn` with the arguments.
   - If the result is a function and different from the last argument (assumed to be a callback), it copies properties from the callback to the result.
   - Returns the result.

## Side Effects
The function modifies the properties of the returned wrapper function and potentially the returned function from the wrapped function call.

## Error Handling
The function throws a TypeError if the input `fn` is not a function.

## Dependencies
This module does not have any external dependencies.

## Performance Considerations
The function uses `Object.keys()` and `forEach` loops, which may have performance implications for objects with many properties. However, for most use cases, this should not be a significant concern.