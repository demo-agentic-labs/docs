---
title: "index.js"
---

## High-level description
This code implements a module for creating directories recursively, similar to the Unix `mkdir -p` command. It provides both asynchronous and synchronous versions of the directory creation function, handling various edge cases and errors.

## Symbols

### `mkdirP`
#### Description
The main asynchronous function for creating directories recursively.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| p | string | The path of the directory to create |
| opts | object or function | Options object or callback function |
| f | function | Callback function (optional if opts is a function) |
| made | string | Internal parameter for tracking created directories |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cb | function | Callback function with (error, madeDirectory) as arguments |

#### Internal Logic
1. Normalize input parameters
2. Resolve the full path
3. Attempt to create the directory
4. If successful, call the callback with the created directory
5. If ENOENT error, recursively create parent directory then retry
6. For other errors, check if directory already exists
7. Call callback with appropriate result

### `mkdirP.sync`
#### Description
The synchronous version of the directory creation function.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| p | string | The path of the directory to create |
| opts | object | Options object |
| made | string | Internal parameter for tracking created directories |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| made | string | The path of the created directory |

#### Internal Logic
1. Normalize input parameters
2. Resolve the full path
3. Try to create the directory synchronously
4. If ENOENT error, recursively create parent directory then retry
5. For other errors, check if directory already exists
6. Return the path of the created directory

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| path | For resolving and manipulating file paths |
| fs | For file system operations |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| mode | number | 0777 & (~process.umask()) | The permission mode for created directories |
| fs | object | Node.js fs module | Custom file system module for operations |

## Error Handling
The code handles various error scenarios:
- ENOENT (No such file or directory): Recursively creates parent directories
- Other errors: Checks if the directory already exists before propagating the error

## Side Effects
The code creates directories in the file system based on the provided paths.

## Performance Considerations
The recursive nature of the directory creation might impact performance for deeply nested directories. The synchronous version may block the event loop for longer operations.