---
title: "Overview"
---

## High-level description
The `@sparticuz/chromium` package is a specialized npm module designed to provide Chromium functionality for serverless platforms, with a particular focus on AWS Lambda compatibility. This package offers utilities for managing Chromium in serverless environments, including setup, font handling, browser configuration, and file decompression.

## What does it do?
This package enables developers to run Chromium-based operations in serverless environments by:

1. Providing a Chromium binary optimized for serverless platforms.
2. Setting up the Chromium environment, including inflating the Chromium binary and related files.
3. Managing custom fonts for use with Chromium.
4. Offering recommended command-line arguments and viewport settings for Chromium in serverless contexts.
5. Decompressing and extracting compressed files (Brotli, Gzip, and tarballs) needed for Chromium operation.

These functionalities allow developers to perform tasks such as web scraping, PDF generation, or running automated tests in serverless environments where traditional browser setups are not feasible.

## Key Files

### build/index.js
This is the main entry point of the package, defining the `Chromium` class with key features:

- `Chromium.font(input)`: Handles custom font management.
- `Chromium.args`: Provides recommended Chromium command-line arguments.
- `Chromium.defaultViewport`: Offers default viewport settings.
- `Chromium.executablePath`: Inflates and returns the path to the Chromium binary.
- `Chromium.headless`: Determines if running in a serverless environment.

Example usage:
```javascript
const chromium = require('@sparticuz/chromium');

async function setupChromium() {
  const executablePath = await Chromium.executablePath;
  const browser = await puppeteer.launch({
    args: Chromium.args,
    defaultViewport: Chromium.defaultViewport,
    executablePath,
    headless: Chromium.headless,
  });
  // Use the browser instance for further operations
}
```

### build/lambdafs.js
This file contains the `LambdaFS` class, providing file system operations specific to Lambda environments:

- `LambdaFS.inflate(filePath)`: Decompresses and extracts compressed files, handling Brotli, Gzip, and tarballs.

Example usage:
```javascript
const LambdaFS = require('./lambdafs');

async function extractChromiumFiles() {
  const chromiumPath = '/path/to/compressed/chromium';
  const extractedPath = await LambdaFS.inflate(chromiumPath);
  console.log(`Chromium extracted to: ${extractedPath}`);
}
```

## Dependencies
The package relies on the following external libraries and Node.js built-in modules:

1. fs: For file system operations.
2. path: For file path manipulations.
3. url: For URL parsing and manipulation.
4. os: For operating system-related utilities.
5. zlib: For compression/decompression utilities.
6. tar-fs (version ^2.1.1): For handling tar archives.

Development dependencies include TypeScript-related packages and tools for cleaning and building the project.

## Configuration
The package uses environment variables to detect the serverless environment and configure its behavior:

- `AWS_LAMBDA_FUNCTION_VERSION`: Indicates an AWS Lambda environment.
- `FUNCTION_NAME`: Indicates a Google Cloud Functions environment.
- `FONTCONFIG_PATH`: Used for font configuration.
- `LD_LIBRARY_PATH`: Used for library path configuration.

Specific file paths and directories are used for operations:

- `/tmp`: Used for storing inflated Chromium files and fonts in serverless environments.
- `/opt/lib`: Used as a fallback library path.

The package is configured to work with Node.js version 14 or higher and includes TypeScript support.

## Performance Considerations
1. The package caches the inflated Chromium binary and related files in the `/tmp` directory to improve performance in subsequent invocations in serverless environments.
2. For file decompression, optimized buffer sizes are used:
   - A high water mark of 2^23 bytes for reading large files.
   - A chunk size of 2^21 bytes for Brotli and Gzip decompression.

These optimizations help in efficiently handling large files and improving the overall performance of Chromium setup in serverless environments.

In conclusion, the `@sparticuz/chromium` package provides a robust solution for running Chromium in serverless environments, handling the complexities of file management, compression, and browser configuration to enable advanced web automation tasks in cloud functions.