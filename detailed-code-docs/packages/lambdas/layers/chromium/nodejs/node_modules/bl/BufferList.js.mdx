---
title: "BufferList.js"
---

## High-level description
This code defines a `BufferList` class, which is a data structure for managing and manipulating multiple buffers as a single entity. It provides various methods for appending, slicing, copying, and searching within the combined buffer list, as well as reading different data types from specific offsets.

## Code Structure
The `BufferList` class is defined with a constructor and numerous prototype methods. It also includes a self-executing function that adds various read methods to the prototype. The main symbols in the code are interconnected through the `BufferList` prototype, with most methods operating on the internal `_bufs` array.

## Symbols

### BufferList (Constructor)
#### Description
Creates a new `BufferList` instance, initializing it with an optional buffer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| buf | Buffer (optional) | Initial buffer to append |

#### Internal Logic
- Calls `BufferList._init` to set up the instance
- Appends the initial buffer if provided

### BufferList._init
#### Description
Initializes a `BufferList` instance with core properties.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| buf | Buffer (optional) | Initial buffer to append |

#### Internal Logic
- Defines a symbol property to identify BufferList instances
- Initializes `_bufs` array and `length` property
- Appends initial buffer if provided

### BufferList.prototype._offset
#### Description
Calculates the internal buffer index and offset for a given overall offset.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| offset | Number | Overall offset in the BufferList |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Array | [bufferIndex, bufferOffset] |

### BufferList.prototype.get
#### Description
Retrieves a single byte at the specified index.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| index | Number | Index of the byte to retrieve |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| byte | Number | The byte at the specified index |

### BufferList.prototype.slice
#### Description
Creates a new Buffer containing a slice of the BufferList.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| start | Number | Start index of the slice |
| end | Number | End index of the slice |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| buffer | Buffer | New Buffer containing the sliced data |

### BufferList.prototype.append
#### Description
Appends a buffer, array, or another BufferList to the current instance.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| buf | Buffer/Array/BufferList/Number/String | Data to append |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| this | BufferList | The current BufferList instance |

### BufferList.prototype.indexOf
#### Description
Searches for a value in the BufferList and returns its index.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| search | String/Buffer/BufferList/Uint8Array | Value to search for |
| offset | Number (optional) | Starting offset for the search |
| encoding | String (optional) | Encoding for string search |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| index | Number | Index of the found value or -1 if not found |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| buffer | Used to access the Buffer class |

## Performance Considerations
The `BufferList` class is designed to efficiently manage multiple buffers, avoiding unnecessary copying when possible. Methods like `slice` and `copy` are optimized to work across multiple internal buffers.

This documentation provides an overview of the main functionality and structure of the `BufferList` class. There are additional methods and features not covered in detail here, such as `shallowSlice`, `consume`, `duplicate`, and various read methods for different data types.