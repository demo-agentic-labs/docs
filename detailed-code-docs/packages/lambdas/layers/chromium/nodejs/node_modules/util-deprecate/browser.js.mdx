---
title: "browser.js"
---

## High-level description
This code implements a utility function `deprecate` that marks functions as deprecated, providing configurable warning behavior. It allows developers to gracefully phase out old functions while notifying users of their deprecated status.

## Symbols

### `deprecate`
#### Description
The `deprecate` function is used to mark a function as deprecated. It wraps the original function with a new one that issues a warning (or throws an error) when called, based on configuration settings.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fn | Function | The function to be marked as deprecated |
| msg | String | The message to display when the deprecated function is called |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| deprecated | Function | A new function that wraps the original, adding deprecation behavior |

#### Internal Logic
1. Checks if deprecation is disabled via `config('noDeprecation')`.
2. If disabled, returns the original function unchanged.
3. If enabled, creates a new `deprecated` function that:
   - Checks if a warning has already been issued.
   - If not warned:
     - Throws an error if `throwDeprecation` is set.
     - Uses `console.trace` if `traceDeprecation` is set.
     - Uses `console.warn` otherwise.
   - Marks that a warning has been issued.
   - Calls and returns the result of the original function.

### `config`
#### Description
A private helper function that checks `localStorage` for boolean configuration values.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | String | The name of the configuration option to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | Whether the configuration option is set to 'true' |

#### Internal Logic
1. Tries to access `global.localStorage` safely (to handle sandboxed environments).
2. If `localStorage` is not available, returns `false`.
3. Retrieves the value for the given name from `localStorage`.
4. Returns `true` if the value (converted to lowercase) is 'true', otherwise `false`.

## Dependencies
This code relies on the global `localStorage` object for configuration, which is typically available in browser environments.

## Configuration
The code uses `localStorage` for configuration. The following options are supported:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| noDeprecation | Boolean | false | If true, deprecation warnings are disabled |
| throwDeprecation | Boolean | false | If true, deprecated function calls throw errors |
| traceDeprecation | Boolean | false | If true, deprecation warnings use `console.trace` instead of `console.warn` |

## Error Handling
The code includes basic error handling for accessing `localStorage` in potentially restricted environments (e.g., sandboxed iframes). If `localStorage` is not available, the `config` function safely returns `false`.