---
title: "buffer_list.js"
---

## High-level description
This code defines a `BufferList` class, which implements a linked list data structure for managing buffers or strings. It provides methods for adding, removing, and manipulating data in the list, as well as utilities for consuming and inspecting the stored data.

## Code Structure
The `BufferList` class is the main symbol in this code. It contains various methods for manipulating the linked list and its data. The class uses a linked list structure with `head` and `tail` pointers, and a `length` property to keep track of the number of elements.

## Symbols

### BufferList
#### Description
A class that implements a linked list for managing buffers or strings.

#### Internal Logic
- Maintains a linked list structure with `head` and `tail` pointers
- Keeps track of the list length
- Provides methods for adding, removing, and manipulating data in the list
- Implements custom data consumption and inspection methods

### BufferList.push(v)
#### Description
Adds a new element to the end of the list.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| v | any | The data to be added to the list |

#### Internal Logic
- Creates a new entry object with the provided data
- Updates the `tail` pointer and increments the length

### BufferList.unshift(v)
#### Description
Adds a new element to the beginning of the list.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| v | any | The data to be added to the list |

#### Internal Logic
- Creates a new entry object with the provided data
- Updates the `head` pointer and increments the length

### BufferList.shift()
#### Description
Removes and returns the first element from the list.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | any | The data of the first element in the list |

#### Internal Logic
- Removes the first element and updates the `head` pointer
- Decrements the length
- Returns the data of the removed element

### BufferList.clear()
#### Description
Clears all elements from the list.

#### Internal Logic
- Resets `head` and `tail` pointers to null
- Sets length to 0

### BufferList.join(s)
#### Description
Joins all elements in the list into a string, using the provided separator.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| s | string | The separator to use between elements |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | string | The joined string of all elements |

### BufferList.concat(n)
#### Description
Concatenates all buffers in the list into a single buffer of the specified size.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| n | number | The size of the resulting buffer |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | Buffer | The concatenated buffer |

### BufferList.consume(n, hasStrings)
#### Description
Consumes a specified amount of bytes or characters from the buffered data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| n | number | The number of bytes or characters to consume |
| hasStrings | boolean | Whether the data contains strings |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | Buffer or string | The consumed data |

#### Internal Logic
- Handles three cases: partial consumption of the first chunk, exact match with the first chunk, or spanning multiple chunks
- Calls `_getString` or `_getBuffer` for multi-chunk consumption based on the `hasStrings` parameter

### BufferList.first()
#### Description
Returns the data of the first element in the list without removing it.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | any | The data of the first element |

### BufferList._getString(n)
#### Description
Consumes a specified amount of characters from the buffered data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| n | number | The number of characters to consume |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | string | The consumed string |

### BufferList._getBuffer(n)
#### Description
Consumes a specified amount of bytes from the buffered data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| n | number | The number of bytes to consume |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ret | Buffer | The consumed buffer |

### BufferList[custom](_, options)
#### Description
Customizes the inspection output of the BufferList instance.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| _ | any | Unused parameter |
| options | object | Inspection options |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| inspected | string | The customized inspection string |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| buffer | Used for Buffer operations |
| util | Used for the `inspect` function |