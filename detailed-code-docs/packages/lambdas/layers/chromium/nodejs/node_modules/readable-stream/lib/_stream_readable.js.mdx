---
title: "_stream_readable.js"
---

## High-level description
This file implements the Readable stream class, which is a fundamental part of Node.js's stream API. It provides functionality for reading data from a source asynchronously, with support for various modes of operation, including flowing and paused modes.

## Code Structure
The code defines the Readable class and its prototype methods, along with several utility functions. The Readable class inherits from the Stream class and implements the readable stream interface. It uses a ReadableState object to manage its internal state.

## Symbols

### `Readable`
#### Description
The main class representing a readable stream. It provides methods for reading data, managing the stream's state, and handling events.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| options | Object | Configuration options for the stream |

#### Internal Logic
- Initializes the stream's state using ReadableState
- Implements methods for reading data, pausing, resuming, and piping to other streams
- Manages events like 'data', 'end', and 'readable'

### `ReadableState`
#### Description
An internal class used to manage the state of a Readable stream.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| options | Object | Configuration options for the stream state |
| stream | Readable | The associated Readable stream |
| isDuplex | boolean | Whether the stream is a Duplex stream |

#### Internal Logic
- Manages buffer, encoding, and flow control
- Tracks the stream's state (e.g., flowing, paused, ended)

### `Readable.prototype.read`
#### Description
Reads and returns data from the stream's internal buffer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| n | number | Number of bytes to read (optional) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chunk | Buffer/String/null | The read data or null if no data is available |

#### Internal Logic
- Determines how much data to read based on the input and current state
- Triggers the '_read' method to fetch more data if necessary
- Emits 'data' events when data is available

### `Readable.prototype.pipe`
#### Description
Pipes the readable stream to a writable destination stream.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dest | Writable | The destination writable stream |
| pipeOpts | Object | Pipe options (optional) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dest | Writable | The destination stream |

#### Internal Logic
- Sets up event listeners for 'data', 'end', and error handling
- Manages backpressure by pausing/resuming the source stream

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| events | For EventEmitter functionality |
| buffer | For Buffer operations |
| util | For utility functions and debugging |
| string_decoder | For string decoding in streams |

## Error Handling
The code includes error handling mechanisms, such as the `errorOrDestroy` function, which either emits an error event or destroys the stream based on the error type.

## Performance Considerations
The code includes optimizations for performance, such as:
- Using a linked list (BufferList) for efficient buffer management
- Implementing flow control to handle backpressure
- Providing options to adjust the high water mark for fine-tuning performance

This implementation of Readable streams is a core part of Node.js's I/O operations and is designed to be efficient and flexible for various use cases.