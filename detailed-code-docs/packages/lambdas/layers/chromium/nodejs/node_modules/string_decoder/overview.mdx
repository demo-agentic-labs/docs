---
title: "Overview"
---

## High-level description
The `string_decoder` directory contains a Node.js module that provides functionality for efficiently converting buffers into JavaScript strings while correctly handling multi-byte characters. This module is a part of Node.js core functionality that has been ported for use in other environments, such as browsers.

## What does it do?
The `string_decoder` module primarily does the following:

1. Decodes buffers (raw binary data) into JavaScript strings.
2. Supports various encodings, including UTF-8, UTF-16LE, Base64, and single-byte encodings like ASCII and Latin1.
3. Handles partial multi-byte characters across multiple writes, ensuring correct decoding of strings even when data is received in chunks.
4. Provides a `StringDecoder` class with methods to write buffers and end the decoding process.
5. Implements efficient decoding algorithms for different encoding types.
6. Handles error cases, such as invalid UTF-8 sequences, by replacing them with the Unicode replacement character (U+FFFD).

This functionality is particularly useful when working with streams of data or when processing large amounts of text data in chunks, ensuring that characters split across buffer boundaries are correctly reconstructed.

## Key Files

1. `lib/string_decoder.js`: This is the main file containing the implementation of the `StringDecoder` class and related functions. It includes:
   - The `StringDecoder` class with `write` and `end` methods.
   - Helper functions for different encodings (UTF-8, UTF-16LE, Base64, etc.).
   - Utility functions for checking and handling UTF-8 bytes and incomplete characters.

2. `package.json`: This file defines the package configuration, including:
   - Package metadata (name, version, description)
   - Main entry point (`lib/string_decoder.js`)
   - Dependencies and development dependencies
   - Scripts for testing and continuous integration
   - Repository information and license

## Dependencies
The `string_decoder` module has one runtime dependency:

- `safe-buffer` (version ~5.2.0): This library provides a safer Buffer implementation, likely used for handling binary data securely.

Development dependencies include:
- `babel-polyfill` (^6.23.0)
- `core-util-is` (^1.0.2)
- `inherits` (^2.0.3)
- `tap` (~0.4.8): Used for running tests

## Configuration
The module doesn't require explicit configuration. However, when using the `StringDecoder` class, you can specify the encoding as a parameter:

```javascript
const { StringDecoder } = require('string_decoder');
const decoder = new StringDecoder('utf8');
```

Supported encodings include:
- 'utf8' (default)
- 'utf16le'
- 'base64'
- Single-byte encodings like 'ascii' and 'latin1'

## Code Examples

1. Basic usage of `StringDecoder`:

```javascript
const { StringDecoder } = require('string_decoder');
const decoder = new StringDecoder('utf8');

const cent = Buffer.from([0xC2, 0xA2]);
console.log(decoder.write(cent)); // Outputs: ¢

const euro = Buffer.from([0xE2, 0x82, 0xAC]);
console.log(decoder.write(euro)); // Outputs: €
```

2. Handling partial multi-byte characters:

```javascript
const decoder = new StringDecoder('utf8');

const buf1 = Buffer.from([0xE2, 0x82]);
const buf2 = Buffer.from([0xAC]);

console.log(decoder.write(buf1)); // Outputs: (empty string, as it's an incomplete character)
console.log(decoder.write(buf2)); // Outputs: €
console.log(decoder.end());       // Outputs: (empty string, as there are no remaining partial characters)
```

3. Decoding Base64:

```javascript
const decoder = new StringDecoder('base64');

const buf = Buffer.from('SGVsbG8gV29ybGQ=');
console.log(decoder.write(buf)); // Outputs: Hello World
```

The `string_decoder` module provides a robust solution for decoding buffers into strings, especially when dealing with streaming data or large text processing tasks. Its ability to handle partial multi-byte characters across multiple writes makes it particularly useful in scenarios where data is received or processed in chunks.