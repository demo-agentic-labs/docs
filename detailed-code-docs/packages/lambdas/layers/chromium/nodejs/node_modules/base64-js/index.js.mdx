---
title: "index.js"
---

## High-level description
This code implements Base64 encoding and decoding functionality. It provides methods to convert between Base64 strings and byte arrays, as well as calculating the byte length of Base64 encoded strings.

## Symbols

### `byteLength(b64)`
#### Description
Calculates the byte length of a Base64 encoded string.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| b64 | string | Base64 encoded string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| length | number | Byte length of the decoded data |

#### Internal Logic
1. Calls `getLens` to get the valid length and number of placeholder characters.
2. Calculates the byte length using the formula: `((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen`

### `toByteArray(b64)`
#### Description
Converts a Base64 encoded string to a byte array.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| b64 | string | Base64 encoded string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| arr | Uint8Array or Array | Byte array representation of the decoded data |

#### Internal Logic
1. Calls `getLens` to get the valid length and number of placeholder characters.
2. Creates a new array of the appropriate length.
3. Decodes the Base64 string in groups of 4 characters, converting them to 3 bytes.
4. Handles any trailing characters based on the number of placeholders.

### `fromByteArray(uint8)`
#### Description
Converts a byte array to a Base64 encoded string.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| uint8 | Uint8Array or Array | Byte array to be encoded |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | string | Base64 encoded string |

#### Internal Logic
1. Processes the input array in chunks of up to 16383 bytes (must be multiple of 3).
2. Calls `encodeChunk` for each chunk to convert it to Base64.
3. Handles any trailing bytes (1 or 2) by padding with '=' characters as needed.
4. Joins all encoded parts into a single string.

### `getLens(b64)`
#### Description
Helper function to calculate the valid length and number of placeholder characters in a Base64 string.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| b64 | string | Base64 encoded string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| [validLen, placeHoldersLen] | [number, number] | Array containing valid length and number of placeholders |

#### Internal Logic
1. Checks if the input length is valid (multiple of 4).
2. Finds the position of the first '=' character (if any) to determine valid length.
3. Calculates the number of placeholder characters.

### `tripletToBase64(num)`
#### Description
Helper function to convert a 24-bit number to four Base64 characters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| num | number | 24-bit number to be converted |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | string | Four Base64 characters |

### `encodeChunk(uint8, start, end)`
#### Description
Helper function to encode a chunk of bytes to Base64.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| uint8 | Uint8Array or Array | Byte array |
| start | number | Start index of the chunk |
| end | number | End index of the chunk |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | string | Base64 encoded string for the chunk |

## Dependencies
The code uses `Uint8Array` if available, otherwise falls back to regular `Array`.

## Performance Considerations
- The code processes data in chunks to optimize memory usage, especially for large inputs.
- It uses lookup tables (`lookup` and `revLookup`) for fast character-to-value and value-to-character conversions.
- The `maxChunkLength` in `fromByteArray` is set to 16383 (must be multiple of 3) to balance between memory usage and performance.

## Error Handling
The code throws an error if the input Base64 string length is not a multiple of 4 in the `getLens` function.