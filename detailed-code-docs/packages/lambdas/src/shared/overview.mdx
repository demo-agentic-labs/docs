---
title: "Overview"
---

## High-level description
This directory contains shared utility functions and classes used across various AWS Lambda functions. It provides functionality for error capturing, CloudWatch metrics reporting, environment variable management, file information retrieval from S3, HTTP error handling, logging, OSS API interactions, secret management, asynchronous delays, and SQS operations.

## What does it do?
The shared utilities in this directory facilitate common tasks in serverless applications:

1. Error tracking and logging using Sentry
2. Reporting custom metrics and memory usage to CloudWatch
3. Managing environment variables and determining the current environment (production, sandbox, staging)
4. Retrieving file metadata from S3 buckets
5. Identifying specific HTTP errors (timeouts, bad gateway) in Axios responses
6. Creating prefixed logging functions for consistent log formats
7. Interacting with an OSS API, including retry logic for network operations
8. Securely retrieving SAML certificates and keys from AWS Secrets Manager
9. Introducing controlled delays in asynchronous code execution
10. Working with Amazon SQS, including message attribute handling

These utilities are designed to be used across multiple Lambda functions, providing a consistent and efficient way to handle common operations in a serverless environment.

## Key Files

1. `capture.ts`: Defines a capture utility for error and message logging using Sentry.
2. `cloudwatch.ts`: Provides a `CloudWatchUtils` class for reporting metrics and memory usage to Amazon CloudWatch.
3. `env.ts`: Offers functions for accessing environment variables and checking the current environment type.
4. `file-info.ts`: Contains a function to retrieve metadata about files stored in Amazon S3.
5. `http.ts`: Provides utility functions for identifying specific types of HTTP errors in Axios responses.
6. `log.ts`: Defines a logging utility function that creates customized logging functions with specified prefixes.
7. `oss-api.ts`: Implements an API client for interacting with an OSS API, including retry logic for network operations.
8. `secrets.ts`: Defines a function to retrieve SAML certificates and keys from AWS Secrets Manager.
9. `sleep.ts`: Offers a utility function for creating delays in asynchronous code execution.
10. `sqs.ts`: Provides a `SQSUtils` class for interacting with Amazon Simple Queue Service (SQS).

## Dependencies
The shared utilities rely on several external libraries and AWS services:

1. AWS SDK: Used for interacting with various AWS services like CloudWatch, S3, and SQS.
2. Sentry: Employed for error tracking and logging.
3. Axios: Used for making HTTP requests in the OSS API client.
4. AWS Lambda Powertools: Utilized for retrieving secrets from AWS Secrets Manager.

## Configuration
Many of the utilities rely on environment variables for configuration:

- `SENTRY_DSN`: Data Source Name for Sentry error tracking
- `ENV_TYPE`: Determines the current environment (production, sandbox, staging)
- `AWS_REGION`: Specifies the AWS region for various services
- Various secret names for SAML certificates and keys

These environment variables should be properly set in the Lambda function configurations to ensure the correct operation of the shared utilities.

In conclusion, this shared directory provides a robust set of utilities that streamline common operations in serverless applications, promoting code reuse and consistency across multiple Lambda functions.