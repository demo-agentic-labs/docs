---
title: "Overview"
---

## High-level description
This directory contains Lambda function implementations for various purposes within the Metriport system. The functions handle tasks such as document conversion, patient discovery, authentication, webhook processing, and data ingestion. They interact with various AWS services like S3, SQS, DynamoDB, and external APIs.

## What does it do?
The Lambda functions in this directory perform a wide range of tasks:

1. Convert clinical documents (CDA to FHIR, FHIR to CDA, FHIR to Medical Record)
2. Process patient discovery requests (inbound and outbound)
3. Handle document queries and retrievals
4. Manage authentication and authorization
5. Process webhooks from various health data providers (Fitbit, Garmin, Withings, Tenovi)
6. Ingest data into OpenSearch
7. Transfer messages between SQS queues
8. Perform scheduled tasks
9. Test and validate the deployed environment

These functions serve as key components in the Metriport system, facilitating data processing, integration with external systems, and maintaining the overall workflow of the healthcare data platform.

## Entry points
The main entry point for each Lambda function is the `handler` function exported in each file. These handlers are triggered by various AWS events (e.g., API Gateway requests, SQS messages, S3 events) and process the incoming data accordingly.

Key files include:
- `cda-to-visualization.ts`: Converts CDA documents to HTML or PDF
- `fhir-to-medical-record.ts`: Generates medical record summaries from FHIR data
- `ihe-gateway-v2-*.ts` files: Handle various IHE (Integrating the Healthcare Enterprise) gateway operations
- `sqs-to-*.ts` files: Process SQS messages for various purposes (e.g., FHIR conversion, OpenSearch ingestion)
- `token-auth.ts`: Implements token-based authentication for API Gateway

## Dependencies
The Lambda functions rely on several shared dependencies and utilities:

1. AWS SDK: For interacting with various AWS services
2. Sentry: For error tracking and monitoring
3. Axios: For making HTTP requests
4. Various Metriport core and shared libraries: For common functionality and utilities

## Configuration
Most Lambda functions use environment variables for configuration, including:

- API URLs
- AWS region
- S3 bucket names
- Database credentials
- Feature flags
- Timeout durations

These environment variables should be properly set in the Lambda function configurations to ensure correct operation.

The `shared` directory contains utility functions for managing environment variables, error capturing, and interacting with various AWS services.

In conclusion, this directory contains a comprehensive set of Lambda functions that form the backbone of the Metriport system's serverless architecture, handling various aspects of healthcare data processing and integration.