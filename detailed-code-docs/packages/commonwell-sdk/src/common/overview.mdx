---
title: "Overview"
---

## High-level description
This directory contains common utility functions, error handling classes, and helper modules for the CommonWell SDK. It provides essential functionality for JWT creation, file downloading, NPI validation, and error management specific to CommonWell and Metriport operations.

## What does it do?
The code in this directory performs several key functions:

1. Error Handling: It defines custom error classes (`CommonwellError` and `MetriportError`) to handle errors specific to CommonWell and Metriport operations, including network-related errors.

2. JWT Creation: It provides a function to create JSON Web Tokens (JWTs) according to CommonWell specifications, including claims for role, subject ID, organization details, purpose of use, and optionally NPI and payload hash.

3. File Downloading: It offers a function to download files from a given URL and write them to a provided output stream, supporting custom headers and Axios instances.

4. NPI Validation: It includes a function to validate 10-digit National Provider Identifier (NPI) numbers using the ISO standard mod 10 Luhn algorithm.

5. Utility Functions: It contains various utility functions for data manipulation, API requests, and patient/person management operations related to the CommonWell Health Alliance API.

## Key Files

1. `commonwell-error.ts`: Defines the `CommonwellError` class for handling CommonWell-specific errors.

2. `make-jwt.ts`: Contains the `makeJwt` function for creating JWTs according to CommonWell specifications.

3. `fileDownload.ts`: Provides the `downloadFile` function for efficient file downloading using streams.

4. `validate-npi.ts`: Implements the `validateNPI` function for validating NPI numbers.

5. `util.ts`: Contains various utility functions and the main `CommonWell` class for interacting with the CommonWell API.

6. `metriport-error.ts`: Defines the `MetriportError` class for custom error handling in the application.

## Dependencies
The code relies on several external libraries and modules:

- `@metriport/shared`: Provides shared utilities and types.
- `axios`: Used for making HTTP requests.
- `jsonwebtoken`: Used for creating and signing JWTs.
- `stream`: Used for efficient file handling.
- `util`: Used for promisifying stream operations.
- `http-status`: Provides HTTP status codes as constants.

## Configuration
The code uses several configuration options and constants:

1. JWT Claims: The `make-jwt.ts` file defines constant claim names used in the JWT payload, such as `roleClaim`, `subjectIdClaim`, `orgNameClaim`, etc.

2. API Mode: The `CommonWell` class in `util.ts` accepts an `apiMode` parameter to determine whether to use the integration or production environment.

3. Organization Details: The `CommonWell` class constructor requires organization-specific information such as certificate, RSA private key, name, and OID.

The code in this directory forms the foundation of the CommonWell SDK, providing essential utilities and error handling mechanisms for interacting with the CommonWell Health Alliance API. It abstracts complex operations like JWT creation, file downloading, and NPI validation, making it easier for developers to work with the CommonWell API while maintaining proper error handling and logging throughout the SDK.