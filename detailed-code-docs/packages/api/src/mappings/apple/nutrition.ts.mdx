---
title: "nutrition.ts"
---

## High-level description
The `mapDataToNutrition` function transforms Apple Health data into a standardized `Nutrition` array. It iterates through various Apple Health data points related to nutrition, aggregates them by date, and maps them to corresponding fields in the `Nutrition` object.

## Code Structure
The `mapDataToNutrition` function uses a helper function `addToNutrition` to handle the aggregation and mapping of individual Apple Health data points. It also utilizes a `dateToIndex` map to efficiently group data by date.

## References
- `Nutrition`: This symbol is referenced from the `@metriport/api-sdk` package and represents the standardized format for nutrition data.
- `AppleHealth`: This symbol is defined in the same file (`./index.ts`) and represents the structure of raw data received from Apple Health.
- `AppleHealthItem`: This symbol is defined in the same file (`./index.ts`) and represents a single data point within the `AppleHealth` data structure.
- `createMetadata`: This symbol is defined in the same file (`./index.ts`) and is used to generate metadata for each entry in the `Nutrition` array.

## Symbols

### `mapDataToNutrition`
#### Description
This function processes raw Apple Health data and converts it into a standardized `Nutrition` array.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | `AppleHealth` | Raw data from Apple Health containing various nutrition-related data points. |
| hourly | `boolean` | Flag indicating whether the data should be aggregated hourly. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| nutrition | `Nutrition[]` | An array of `Nutrition` objects representing the processed nutrition data. |

#### Internal Logic
1. Initializes empty arrays for `nutrition` and `dateToIndex`.
2. Defines a helper function `addToNutrition` to handle the aggregation and mapping of individual Apple Health data points.
3. Iterates through various Apple Health data points related to macros and micros.
4. For each data point:
    - Extracts the date and value.
    - Calls `addToNutrition` to add or update the data in the `nutrition` array based on the date.
5. Returns the `nutrition` array.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @metriport/api-sdk | Provides the `Nutrition` interface for standardized nutrition data. |
| dayjs | Used for date manipulation and formatting. |
