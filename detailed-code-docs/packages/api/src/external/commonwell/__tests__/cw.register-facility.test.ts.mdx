---
title: "cw.register-facility.test.ts"
---

## High-level description
This test file contains unit tests for the `createOrUpdateFacilityInCw` function, which is responsible for creating or updating a facility in CommonWell. The tests verify that the function calls the `createOrUpdateCWOrganization` method with the correct parameters for both non-OBO (On Behalf Of) and OBO facilities.

## Code Structure
The main function being tested is `createOrUpdateFacilityInCw`. It uses the `createOrUpdateCWOrganization` function from the `createOrUpdateCwOrg` module. The tests mock this function and verify its calls.

## Symbols

### `createOrUpdateFacilityInCw`
#### Description
This function creates or updates a facility in CommonWell. It takes facility information, customer organization details, and CommonWell-specific data as input.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cxId | string | Customer ID |
| facility | Facility | Facility object containing details |
| cxOrgName | string | Customer organization name |
| cxOrgType | OrgType | Customer organization type |
| cwOboOid | string \| undefined | CommonWell OBO OID |

#### Internal Logic
1. Builds the CommonWell organization name using `buildCwOrgNameForFacility`.
2. Calls `createOrUpdateCWOrganization` with the constructed organization data.

### Test: "calls hie creates with expected params when createOrUpdateFacilityInCw is called - non-obo"
#### Description
This test verifies that `createOrUpdateFacilityInCw` calls `createOrUpdateCWOrganization` with the correct parameters for a non-OBO facility.

#### Internal Logic
1. Arranges test data for a non-OBO facility.
2. Acts by calling `createOrUpdateFacilityInCw`.
3. Asserts that `createOrUpdateCWOrganization` was called with the expected parameters.

### Test: "calls hie creates with expected params when createOrUpdateFacilityInCw is called - obo"
#### Description
This test verifies that `createOrUpdateFacilityInCw` calls `createOrUpdateCWOrganization` with the correct parameters for an OBO facility.

#### Internal Logic
1. Arranges test data for an OBO facility.
2. Acts by calling `createOrUpdateFacilityInCw`.
3. Asserts that `createOrUpdateCWOrganization` was called with the expected parameters, including the OBO-specific data.

## Dependencies
- @faker-js/faker: Used for generating fake data in tests.
- @metriport/core: Provides core types and utilities.
- @metriport/commonwell-sdk: CommonWell SDK for interacting with the CommonWell API.
- Various internal modules for facility and organization management.

## Configuration
The tests use Jest's mocking capabilities to mock external dependencies and isolate the function being tested.