---
title: "coverage-enhancer-factory.ts"
---

## High-level description
This code defines a factory function `makeCoverageEnhancer` that creates and returns a `CoverageEnhancer` instance. The function sets up the necessary dependencies and configuration for the coverage enhancer, which is used to improve patient data coverage in the CommonWell Health Alliance network.

## Code Structure
The main function `makeCoverageEnhancer` creates and configures the necessary components (CookieManager, CommonWell Management API) and returns a `CoverageEnhancerApiLocal` instance. It relies on configuration values from the `Config` class and imports from various core modules.

## Symbols

### `makeCoverageEnhancer`
#### Description
This function creates and returns a `CoverageEnhancer` instance, specifically a `CoverageEnhancerApiLocal`. It sets up the necessary dependencies and configuration for the coverage enhancer.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| return value | CoverageEnhancer \| undefined | A configured CoverageEnhancer instance or undefined if required configuration is missing |

#### Internal Logic
1. Retrieves the CommonWell Management URL and Cookie ARN from the Config.
2. If either is missing, logs a warning and returns undefined.
3. Creates a `CookieManagerOnSecrets` instance using the Cookie ARN and AWS region.
4. Creates a CommonWell Management API instance using the cookie manager and base URL.
5. Defines an empty `getOrgIdExcludeList` function (TODO: this is temporary).
6. Returns a new `CoverageEnhancerApiLocal` instance with the configured dependencies.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @metriport/core | Provides core functionality and types |
| ../../../shared/config | Provides application configuration |

## TODOs
- The `getOrgIdExcludeList` function is currently returning an empty array to accelerate development. This is noted as temporary, and the code is expected to be deprecated soon.

## Performance Considerations
The function includes a comment about returning an empty exclude list to accelerate development. This might have performance implications in a production environment and should be addressed before final deployment.

## Error Handling
The function logs warnings and returns `undefined` if required configuration values (CommonWell Management URL or Cookie ARN) are missing. This allows the calling code to handle the absence of a CoverageEnhancer gracefully.