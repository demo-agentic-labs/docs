---
title: "create-or-update-cw-organization.ts"
---

## High-level description
This code implements functionality for creating, updating, and managing organizations in the CommonWell Health Alliance (CW) system. It provides methods to interact with the CommonWell API, handle organization data, and synchronize it with the local database.

## Code Structure
The main file defines two functions: `createOrUpdateCWOrganization` and `getAndUpdateCWOrgAndMetriportOrg`. These functions utilize various imported modules and types to perform their operations. The code interacts with the CommonWell API, handles organization data, and updates the local database.

## Symbols

### `createOrUpdateCWOrganization`
#### Description
This function creates or updates an organization in the CommonWell system.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cxId | string | Customer ID |
| org | CWOrganization | Organization data |
| isObo | boolean | Indicates if it's an "on behalf of" organization |

#### Internal Logic
1. Checks if the organization exists in CommonWell.
2. If it exists, updates the organization.
3. If it doesn't exist, creates a new organization.

### `getAndUpdateCWOrgAndMetriportOrg`
#### Description
This function retrieves and updates both the CommonWell organization and the corresponding Metriport organization.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cxId | string | Customer ID |
| oid | string | Organization ID |
| active | boolean | Active status |
| org | OrganizationModel | Organization model |
| facility | FacilityModel (optional) | Facility model |

#### Internal Logic
1. Retrieves the CommonWell organization data.
2. Creates or updates the CommonWell organization.
3. Updates the local database (either facility or organization) with the new active status.

## Dependencies
The code relies on several imported modules and types from other files in the project, including models, API functions, and utility functions.

## Error Handling
The code uses try-catch blocks to handle potential errors during API calls and database operations. Errors are not explicitly thrown but are likely propagated up the call stack.

## Performance Considerations
The code makes external API calls to CommonWell, which could potentially impact performance. Caching mechanisms or rate limiting might be necessary for high-volume scenarios.