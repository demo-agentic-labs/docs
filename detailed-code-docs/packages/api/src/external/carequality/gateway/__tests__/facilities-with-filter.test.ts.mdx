---
title: "facilities-with-filter.test.ts"
---

## High-level description
The `facilitiesWithEpicFilter` function filters a list of `CQDirectoryEntry` objects based on whether Epic functionality is enabled. If Epic is enabled, all facilities are returned. If Epic is disabled, facilities managed by "Epic" are excluded.

## References
This function uses the `EPIC_ORG_NAME` constant defined in the same file.

## Symbols

### `facilitiesWithEpicFilter`
#### Description
This function filters a list of `CQDirectoryEntry` objects based on the `isEpicEnabled` flag. If `isEpicEnabled` is true, it returns the original list. If `isEpicEnabled` is false, it filters out entries where the `managingOrganization` is "Epic".

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| `cqDirectoryEntries` | `CQDirectoryEntry[]` | An array of `CQDirectoryEntry` objects representing healthcare facilities. |
| `isEpicEnabled` | `boolean` | A flag indicating whether Epic functionality is enabled. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value) | `CQDirectoryEntry[]` | The filtered array of `CQDirectoryEntry` objects. |

#### Internal Logic
1. Checks the value of the `isEpicEnabled` flag.
2. If `isEpicEnabled` is true, returns the original `cqDirectoryEntries` array.
3. If `isEpicEnabled` is false, filters the `cqDirectoryEntries` array using the `filter` method.
4. The `filter` method excludes entries where the `managingOrganization` property, converted to lowercase and trimmed, is equal to `EPIC_ORG_NAME` converted to lowercase.

## Side Effects
This function has no side effects. It does not modify the input array or any external state.

## Error Handling
This function does not implement any specific error handling.
