---
title: "facility.test.ts"
---

## High-level description
This file contains unit tests for the `isFacilityActiveForHie` function, which determines if a facility is active for a specific Health Information Exchange (HIE). The tests cover various scenarios for both Carequality (CQ) and CommonWell (CW) HIEs.

## Code Structure
The main function being tested is `isFacilityActiveForHie`. The tests are organized into describe blocks for general cases, Carequality-specific cases, and CommonWell-specific cases.

## Symbols

### `describe("isFacilityActiveForHie", ...)`
#### Description
This is the main test suite for the `isFacilityActiveForHie` function.

#### Internal Logic
The test suite contains three main sections:
1. A test for invalid MedicalDataSource
2. Tests for Carequality (CQ)
3. Tests for CommonWell (CW)

### `it("throws if invalid MedicalDataSource", ...)`
#### Description
This test checks if the function throws an error when an invalid MedicalDataSource is provided.

#### Internal Logic
1. Arrange: Create a facility with initiatorOnly types for both CQ and CW.
2. Act & Assert: Expect the function to throw when called with an invalid MedicalDataSource.

### `describe("CQ", ...)`
#### Description
This describe block contains tests specific to Carequality.

### `it("returns true when obo is active", ...)`
#### Description
This test checks if the function returns true when the Carequality OBO (On Behalf Of) is active.

#### Internal Logic
1. Arrange: Create a facility with initiatorOnly type and active CQ.
2. Act: Call `isFacilityActiveForHie` with the facility and Carequality as MedicalDataSource.
3. Assert: Expect the result to be truthy.

### `it("returns false when obo is not active", ...)`
#### Description
This test checks if the function returns false when the Carequality OBO is not active.

#### Internal Logic
1. Arrange: Create a facility with initiatorOnly type and inactive CQ.
2. Act: Call `isFacilityActiveForHie` with the facility and Carequality as MedicalDataSource.
3. Assert: Expect the result to be falsy.

### `describe("CW", ...)`
#### Description
This describe block contains tests specific to CommonWell.

### `it("returns true when obo is active", ...)`
#### Description
This test checks if the function returns true when the CommonWell OBO is active.

#### Internal Logic
1. Arrange: Create a facility with initiatorOnly type and active CW.
2. Act: Call `isFacilityActiveForHie` with the facility and CommonWell as MedicalDataSource.
3. Assert: Expect the result to be truthy.

### `it("returns false when obo is not active", ...)`
#### Description
This test checks if the function returns false when the CommonWell OBO is not active.

#### Internal Logic
1. Arrange: Create a facility with initiatorOnly type and inactive CW.
2. Act: Call `isFacilityActiveForHie` with the facility and CommonWell as MedicalDataSource.
3. Assert: Expect the result to be falsy.

## Dependencies
- @metriport/core/external/index: Provides the MedicalDataSource enum.
- ../../medical/__tests__/facility: Provides the `makeFacility` function for creating test facilities.
- ../facility: Provides the FacilityType enum and isFacilityActiveForHie function being tested.