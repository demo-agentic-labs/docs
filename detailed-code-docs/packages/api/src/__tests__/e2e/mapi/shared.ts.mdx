---
title: "shared.ts"
---

## High-level description
This file defines types and constants shared between different end-to-end (E2E) test suites for the Metriport Medical API. It includes API endpoints, headers, client instances, and a context object used to store test data.

## Code Structure
This file primarily defines constants and a type (`E2eContext`) that are used by other E2E test files. The constants include API endpoints, headers, and client instances for both the Metriport Medical API and the FHIR server. The `E2eContext` type defines the structure for holding data related to a test scenario, such as facility, patient, and FHIR resources.

## References
- `getCxIdFromApiKey`: This function is imported from `../../../routes/middlewares/auth` and is used to extract the customer ID from the API key.

## Symbols
### `ACCOUNT_PATH`
#### Description
A constant string representing the API endpoint path for CX account management.

#### Inputs
_N/A_ (constant)

#### Outputs
_N/A_ (constant)

### `CUSTOMER_PATH`
#### Description
A constant string representing the API endpoint path for customer management.

#### Inputs
_N/A_ (constant)

#### Outputs
_N/A_ (constant)

### `MAPI_ACCESS`
#### Description
A constant string representing the API endpoint path for managing access to the Medical API.

#### Inputs
_N/A_ (constant)

#### Outputs
_N/A_ (constant)

### `fhirHeaders`
#### Description
A constant object representing the headers to be used for FHIR API requests. It includes the `x-api-key` header with the `testApiKey`.

#### Inputs
_N/A_ (constant)

#### Outputs
_N/A_ (constant)

### `cxId`
#### Description
A constant string representing the customer ID extracted from the `testApiKey` using the `getCxIdFromApiKey` function.

#### Inputs
_N/A_ (constant)

#### Outputs
_N/A_ (constant)

### `fhirApi`
#### Description
An instance of the `MedplumClient` initialized with the base URL of the FHIR server. This client is used to interact with the FHIR server during E2E tests.

#### Inputs
_N/A_ (constructor call)

#### Outputs
_N/A_ (constructor call)

### `medicalApi`
#### Description
An instance of the `MetriportMedicalApi` initialized with the `testApiKey` and base URL. This client is used to interact with the Metriport Medical API during E2E tests.

#### Inputs
_N/A_ (constructor call)

#### Outputs
_N/A_ (constructor call)

### `E2eContext`
#### Description
A type alias defining the structure of the context object used to store data during E2E tests. It includes properties for storing information about the facility, patient, FHIR resources, and other test-related data.

#### Inputs
_N/A_ (type alias)

#### Outputs
_N/A_ (type alias)
```typescript
export type E2eContext = {
  facility?: Facility | undefined;
  patient?: PatientDTO | undefined;
  patientFhir?: PatientWithId | undefined;
  consolidatedPayload?: Bundle&lt;Resource&gt; | undefined;
  allergyIntolerance?: AllergyIntolerance | undefined;
  documentReference?: DocumentReference | undefined;
  binary?: Binary | undefined;
  url?: string | undefined;
  mrContentBuffer?: Buffer | undefined;
  expectedWebhookMeta?: Record&lt;string, string&gt; | undefined;
  putConsolidatedDataRequestId?: string | undefined;
};
```

## Dependencies
- `@medplum/core`: Provides the `MedplumClient` for interacting with the FHIR server.
- `@metriport/api-sdk`: Provides the `MetriportMedicalApi` for interacting with the Metriport Medical API.
- `@metriport/core/external/fhir/__tests__/patient`: Provides the `PatientWithId` type.

