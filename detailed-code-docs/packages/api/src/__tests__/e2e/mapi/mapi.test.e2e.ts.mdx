---
title: "mapi.test.e2e.ts"
---

## High-level description
This code defines end-to-end (E2E) tests for the MAPI (Metriport Medical API) component of the application. It sets up a test environment, runs various test suites for different functionalities, and then tears down the environment. 

## Code Structure
The code first imports necessary modules and defines constants for test duration and API endpoints. It then sets up the test environment before all tests and tears it down afterward. The main `describe` block groups together different test suites, each focusing on a specific aspect of the MAPI, such as settings, organization, facility, patient, etc. Each test suite is defined in a separate file and imported here.

## References
- `initMapiE2e`, `tearDownMapiE2e`: Functions responsible for setting up and tearing down the MAPI E2E test environment.
- `runSettingsTests`, `runOrganizationTests`, `runFacilityTestsPart1`, `runFacilityTestsPart2`, `runPatientTestsPart1`, `runPatientTestsPart2`, `runConsolidatedTests`, `runDocumentQueryTests`: Functions that define and run tests for specific MAPI functionalities.
- `E2eContext`: An interface defining the structure of the context object shared across different test suites.

## Symbols

### `describe`
#### Description
This function is from the Jest testing framework and defines a test suite. It groups together related tests.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| description | string | A description of the test suite. |
| callback | function | A function that defines the tests for the suite. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | The function itself doesn't return a value, but it runs the tests defined in the callback function. |

#### Internal Logic
The `describe` function is used to structure the E2E tests. It groups together related tests into logical units, making it easier to understand the test suite and identify which functionalities are being tested.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dayjs | Library for parsing, validating, manipulating, and displaying dates and times in JavaScript. |
| duration plugin for dayjs | Plugin that extends dayjs with duration functionality. |
| jest | JavaScript testing framework. |
| initMapiE2e, tearDownMapiE2e, run*Tests functions | Custom functions defined in other files for setting up the test environment and running specific test suites. |
| E2eContext | Custom interface defined in another file for sharing context across test suites. |

## Configuration
- `maxTotalTestDuration`: Defines the maximum allowed duration for the entire test suite (12 minutes).
- `jest.setTimeout`: Sets the timeout for each test to the maximum total test duration.

## TODOs
N/A
