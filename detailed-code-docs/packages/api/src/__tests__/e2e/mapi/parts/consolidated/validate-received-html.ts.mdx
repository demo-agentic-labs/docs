---
title: "validate-received-html.ts"
---

## High-level description
This script validates a consolidated HTML file received from the API against the validation logic used in E2E tests. It reads an HTML file, extracts relevant information, and compares it against expected values. The script outputs whether the validation was successful or not.

## References
- `checkConsolidatedHtml`: This function, imported from another module, performs the actual validation of the HTML content.

## Symbols
### `validate-received-html.ts`
#### Description
This script loads a consolidated HTML file, extracts patient data, and validates it against expected values using the `checkConsolidatedHtml` function. 

#### Inputs
This script doesn't accept command line arguments. It relies on manually setting the following variables:
- `patientId`: The ID of the patient whose data is in the HTML.
- `lastName`: The last name of the patient.
- `allergyId`: The ID of an allergy associated with the patient.
- `receivedFileName`: The name of the HTML file to validate.

#### Outputs
The script prints a message to the console indicating whether the validation was successful. It also generates a diff file if the validation fails.

#### Internal Logic
1. **Setup:** Imports necessary modules, including `dayjs` for date manipulation, `fs` for file system access, and the `checkConsolidatedHtml` function.
2. **Configuration:** Defines variables to store patient data, file names, and allergy ID. These need to be manually updated to match the HTML file being validated.
3. **Load HTML:** Reads the contents of the specified HTML file.
4. **Validation:** Calls the `checkConsolidatedHtml` function with the HTML content, patient data, and file name information.
5. **Output:** Prints the validation result to the console.

## Side Effects
- If the validation fails, the script generates a diff file named "{receivedFileName}_validate.html" highlighting the discrepancies.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dayjs      | Date and time manipulation. |
| fs         | File system access for reading the HTML file. |
| checkConsolidatedHtml (from `./consolidated`) |  Validates the HTML content against expected values. |
