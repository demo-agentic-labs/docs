---
title: "2023-02-22_00_create-mapi-access.ts"
---

## High-level description
This code defines a database migration script using Sequelize. It creates a table named "mapi_access" with a single column "cx_id" as the primary key. The script also includes the corresponding down migration to drop the table.

## References
- `MAPIAccess` from "../../models/medical/mapi-access"
- `shared.createTable` from "../migrations-shared"

## Symbols
### `up`
#### Description
This asynchronous function defines the steps to apply the migration. It creates the "mapi_access" table within a transaction.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| \{ context: queryInterface \} | \{ context: QueryInterface \} | An object containing the Sequelize QueryInterface instance. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise&lt;void&gt; | Promise&lt;void&gt; | A promise that resolves when the migration is complete. |

#### Internal Logic
1. Starts a database transaction.
2. Calls the `createTable` function from the shared module to create the "mapi_access" table with the specified columns and options.
3. Commits the transaction.

### `down`
#### Description
This asynchronous function defines the steps to revert the migration. It drops the "mapi_access" table within a transaction.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| \{ context: queryInterface \} | \{ context: QueryInterface \} | An object containing the Sequelize QueryInterface instance. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise&lt;void&gt; | Promise&lt;void&gt; | A promise that resolves when the migration rollback is complete. |

#### Internal Logic
1. Starts a database transaction.
2. Calls the `dropTable` function of the QueryInterface to drop the "mapi_access" table.
3. Commits the transaction.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| sequelize | ORM for interacting with the database. |
| umzug | Migration management library. |

## Error Handling
The code uses transactions to ensure atomicity of migration operations. If any error occurs during the up or down migration, the transaction will be rolled back, leaving the database in a consistent state.
