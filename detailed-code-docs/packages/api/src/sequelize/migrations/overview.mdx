---
title: "Overview"
---

## High-level description
This directory contains database migration scripts for the API component of the project. These scripts use Sequelize ORM to define and manage changes to the database schema over time. The migrations cover a wide range of operations, including creating new tables, altering existing tables, adding indexes, and modifying column properties.

## What does it do?
The migration scripts in this directory collectively manage the evolution of the database schema. They allow developers to:

1. Create new tables for various entities like users, organizations, facilities, patients, and more.
2. Add, modify, or remove columns from existing tables to accommodate new features or data requirements.
3. Create and drop indexes to optimize query performance.
4. Implement data transformations, such as splitting or combining columns.
5. Add constraints and relationships between tables.
6. Implement versioning and change tracking for certain tables.

Each migration script typically contains an `up` function to apply changes and a `down` function to revert them, enabling both forward and backward migrations.

## Key Files
While all files in this directory are important for maintaining the database schema, some notable migrations include:

1. `2022-12-01_00_init.ts`: Initializes the database with the `connected_user` table and sets up a trigger for updating timestamps.

2. `2023-07-20_00_alter-organization-add-oid.ts`, `2023-07-20_01_alter-facility-update-id.ts`, `2023-07-20_02_alter-patient-update-id.ts`: These migrations update the ID systems for organizations, facilities, and patients, implementing UUIDv7.

3. `2023-12-06_00_create-earth-distance.ts`: Adds PostgreSQL extensions for geospatial calculations.

4. `2024-04-18_00_update-facility-organization.ts`: Adds new columns to the `facility` and `organization` tables, including OIDs and facility numbers.

5. `2024-06-04_00_create-cw-patient-data.ts`: Creates a new table for storing patient data specific to a certain context (CW).

6. `2024-08-06_00_create-feedback.ts`: Implements tables for storing user feedback.

These migrations demonstrate the evolution of the database schema to support new features, improve data organization, and optimize performance.

## Dependencies
The migration scripts primarily depend on:

1. Sequelize (^6.32.1): An ORM for Node.js, used for defining models and interacting with the database.
2. Umzug: A migration framework for Node.js, used in conjunction with Sequelize to manage the execution of migrations.
3. @metriport/core: A local package that provides utility functions and shared types.

## Configuration
The migration scripts themselves don't contain configuration settings. However, they rely on the Sequelize configuration defined elsewhere in the project (likely in a `config.js` or similar file) to connect to the correct database and apply the migrations.

The execution and management of these migrations are typically handled by scripts or commands defined in the project's package.json or a separate migration runner file.