---
title: "2023-11-10_00-alter-patient-add-externalID.ts"
---

## High-level description
This code defines a database migration using Sequelize. It adds a new column named "external_id" to the "patient" table. The migration is reversible, meaning it can be applied and rolled back cleanly.

## Symbols

### `up`
#### Description
This asynchronous function defines the steps to apply the migration, adding the "external_id" column to the "patient" table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| \{ context: queryInterface \} | Object | An object containing the Sequelize QueryInterface instance, used to interact with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise&lt;void&gt; | Promise | A promise that resolves when the migration is successfully applied. |

#### Internal Logic
1. Starts a database transaction to ensure atomicity.
2. Uses `queryInterface.addColumn` to add a new column named "external_id" to the "patient" table.
   - The column type is `DataTypes.STRING`, allowing for text-based external IDs.
   - `allowNull: true` permits the column to contain null values.
3. Commits the transaction if all operations within it are successful.

### `down`
#### Description
This asynchronous function defines the steps to revert the migration, removing the "external_id" column from the "patient" table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| \{ context: queryInterface \} | Object | An object containing the Sequelize QueryInterface instance. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise&lt;void&gt; | Promise | A promise that resolves when the migration rollback is complete. |

#### Internal Logic
1. Starts a database transaction to ensure atomicity.
2. Uses `queryInterface.removeColumn` to delete the "external_id" column from the "patient" table.
3. Commits the transaction if the column removal is successful.

## References
- `DataTypes` from "sequelize": Used to specify the data type of the new column.
- `Migration` from "..":  This likely refers to a type definition for migration functions within the application's codebase.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| sequelize | Provides the database interface and migration utilities. |


