---
title: "connected-user.ts"
---

## High-level description
This code defines the `ConnectedUser` model, which represents a user connected to the Metriport API. It includes properties for user identification, provider mapping, and methods for setting up the database table. The model is used to manage user connections to various health data providers.

## Code Structure
The `ConnectedUser` class extends `BaseModel` and defines the structure and behavior of connected users in the system. It includes properties like `cxId`, `cxUserId`, and `providerMap`, which are used to store user-specific information and provider connections.

## Symbols

### `ConnectedUser`
#### Description
A class representing a user connected to the Metriport API, extending the `BaseModel` class.

#### Internal Logic
- Defines the table name as "connected_user"
- Declares properties: `cxId`, `cxUserId`, and `providerMap`
- Implements a `setup` method to initialize the model with Sequelize

### `ProviderMapItem`
#### Description
A type definition for an item in the provider map, containing token information and connected device details.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| token | string | User authorization token |
| secret | string (optional) | User authorization secret (for OAuth1) |
| scopes | string[] (optional) | Scopes authorized to be accessed by the app |
| connectedDeviceIds | string[] (optional) | List of connected devices |
| deviceUserId | string (optional) | ID used in other services |

### `ProviderMap`
#### Description
A type definition for the provider map, which is a record of provider options and their corresponding `ProviderMapItem`.

### `ConnectedUser.setup`
#### Description
A static method to set up the ConnectedUser model with Sequelize.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| sequelize | Sequelize | The Sequelize instance to use for setup |

#### Internal Logic
- Initializes the model with attributes including `cxId`, `cxUserId`, and `providerMap`
- Sets up the model options, including the table name

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| sequelize | ORM for database operations |
| @metriport/api-sdk | Provides ProviderOptions type |
| ./_default | Imports BaseModel and ModelSetup types |

## Configuration
The model defines configuration for the database table, including column names and types.

## Error Handling
This file doesn't implement specific error handling mechanisms beyond what's provided by Sequelize and the base model.