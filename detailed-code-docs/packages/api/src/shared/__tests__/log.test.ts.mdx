---
title: "log.test.ts"
---

## High-level description
This file contains unit tests for the `errorToString` function from the `log.ts` module. The tests cover various scenarios of error handling, including regular Errors, MetriportErrors, and errors with causes and additional information.

## Code Structure
The file consists of a single `describe` block for the `errorToString` function, containing multiple test cases that verify different aspects of the function's behavior.

## References
- `MetriportError` from "../../errors/metriport-error"
- `errorToString` from "../log"

## Symbols

### `describe("errorToString", ...)`
#### Description
This is the main test suite for the `errorToString` function. It contains multiple test cases that cover various scenarios and edge cases.

#### Internal Logic
The test suite uses Jest's testing framework to run individual test cases. Each test case sets up a specific scenario, calls the `errorToString` function, and verifies the expected output.

### `beforeEach(() =&gt; { jest.restoreAllMocks(); })`
#### Description
This hook runs before each test case, restoring all mocked functions to their original implementation.

### Individual test cases
Each test case follows a similar structure:

#### Description
Describes the specific scenario being tested.

#### Internal Logic
1. Arrange: Set up the test data, including error messages and error objects.
2. Act: Call the `errorToString` function with the prepared error and options.
3. Assert: Verify that the returned string matches the expected output.

#### Examples of test cases:

1. "returns error message when regular Error"
2. "returns error message when MetriportError"
3. "returns error message when no cause but detailed=true"
4. "returns single error message when has causes but detailed=false"
5. "has default detailed=true when not defined"
6. "returns complete error message when has causes and detailed=true"
7. "includes additionalInfo when detailed=true"
8. "includes additionalInfo from cause when detailed=true"

These test cases cover various scenarios, including:
- Different types of errors (Error, MetriportError)
- Errors with and without causes
- Errors with and without additional information
- Different values for the `detailed` option

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @faker-js/faker | Generating random test data |
| node:util | Using the `inspect` function for object stringification |
| jest | Testing framework (implied by the use of `describe`, `it`, `expect`, etc.) |

## Error Handling
The tests focus on verifying the correct handling and string representation of errors by the `errorToString` function. They cover various error scenarios and configurations.