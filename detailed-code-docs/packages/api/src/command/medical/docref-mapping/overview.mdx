---
title: "Overview"
---

## High-level description
This directory contains code related to document reference mapping functionality within a medical data management system. It provides utilities for creating, retrieving, and managing mappings between external document references and internal Metriport IDs.

## What does it do?
The code in this directory facilitates the following workflows:

1. Creating and retrieving document reference mappings: It allows the system to associate external document identifiers with internal Metriport IDs, enabling efficient tracking and management of medical documents from various sources.

2. Querying document reference mappings: The system can retrieve mappings based on various criteria such as patient ID, context ID, external ID, and creation date range.

3. Removing document reference mappings: It provides functionality to remove specific mappings when they are no longer needed or valid.

These operations are crucial for maintaining a coherent link between external medical document references and the internal system, ensuring proper document management and retrieval across different medical data sources.

## Key Files

1. `get-docref-mapping.ts`:
   - Contains functions for retrieving and creating document reference mappings.
   - Provides utilities like `getDocRefMapping`, `getAllDocRefMapping`, `getOrCreateDocRefMapping`, and `getDocRefMappings`.
   - Interacts with the database using Sequelize ORM to perform CRUD operations on `DocRefMapping` entities.

2. `remove-docref-mapping.ts`:
   - Contains the `removeDocRefMapping` function for deleting a specific document reference mapping from the database.
   - Used in conjunction with document download triggers in the CommonWell integration.

3. `tsconfig.json`:
   - Configures TypeScript compiler options for the module.
   - Extends the base project configuration and enables strict type checking.

## Dependencies
- `@metriport/core/external/index`: Provides the `MedicalDataSource` enum for specifying the source of medical data.
- `@metriport/core/util/uuid-v7`: Offers the `uuidv7` function for generating UUIDs.
- `sequelize`: ORM used for database interactions.

## Configuration
The `tsconfig.json` file configures the TypeScript compiler for this module:
- Extends the base configuration from `../../../../tsconfig.json`.
- Includes all TypeScript files in the current directory and subdirectories.
- Excludes test files (`./**/*.test.ts`).
- Enables strict type checking and unchecked indexed access checks.

## Error Handling
- The `getOrCreateDocRefMapping` function throws an error if the `DocRefMapping` is not found after the upsert operation.
- The TypeScript configuration enables strict type checking, which helps prevent type-related errors at compile-time.

In summary, this directory provides essential functionality for managing document reference mappings in a medical data system, enabling efficient tracking and retrieval of medical documents from various external sources.