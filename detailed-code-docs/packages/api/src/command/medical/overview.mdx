---
title: "Overview"
---

## High-level description
This directory contains the core functionality for managing medical data within the API. It includes modules for handling various aspects of medical information, including patient records, organizations, facilities, document references, and interactions with Health Information Exchanges (HIEs).

## What does it do?
The code in this directory performs several key functions:

1. Patient Management: It provides functionality to create, update, delete, and retrieve patient records. This includes handling patient matching, data consolidation, and interactions with external systems like Commonwell and Carequality.

2. Organization and Facility Management: It manages medical organizations and facilities, including creation, updates, and synchronization with FHIR servers.

3. Document Handling: It manages medical documents, including querying, downloading, converting, and processing documents from various sources.

4. Health Information Exchange (HIE) Integration: It facilitates interactions with HIEs like Commonwell and Carequality for patient discovery and document retrieval.

5. API Access Control: It manages access to the Medical API (MAPI) for different customers and organizations.

6. Data Conversion: It handles conversion between different medical data formats, such as FHIR and CDA.

7. Webhook Management: It processes and sends webhooks related to various medical data operations.

## Entry points
The main entry points for this module are spread across various subdirectories:

1. Patient-related operations: `patient/create-patient.ts`, `patient/update-patient.ts`, `patient/delete-patient.ts`, `patient/get-patient.ts`
2. Organization management: `organization/create-organization.ts`, `organization/update-organization.ts`, `organization/get-organization.ts`
3. Facility management: `facility/create-facility.ts`, `facility/update-facility.ts`, `facility/delete-facility.ts`, `facility/get-facility.ts`
4. Document operations: `document/document-query.ts`, `document/document-download.ts`, `document/process-doc-query-webhook.ts`
5. MAPI access control: `mapi-access.ts`

## Key Files

1. `patient/`: Contains files for patient CRUD operations, data consolidation, and HIE interactions.
2. `organization/`: Manages medical organizations, including FHIR server synchronization.
3. `facility/`: Handles facility management and access control.
4. `document/`: Manages document querying, downloading, and processing.
5. `mapi-access.ts`: Controls access to the Medical API.
6. `admin/`: Contains administrative functions for API quota monitoring, database maintenance, and HIE overviews.
7. `docref-mapping/`: Manages mappings between external document references and internal IDs.

## Dependencies
The code relies on several external libraries and internal modules:

1. `@medplum/fhirtypes`: Provides FHIR data types and interfaces.
2. `@metriport/core`: Contains core domain logic and utilities.
3. `@metriport/shared`: Provides shared types and utilities.
4. `@metriport/commonwell-sdk` and `@metriport/carequality-sdk`: Interfaces with HIEs.
5. Sequelize: ORM for database interactions.
6. AWS SDK: For interacting with AWS services.
7. dayjs: For date and time manipulation.
8. lodash: Utility library for various operations.

## Configuration
The code uses configuration from the `Config` object, which likely includes:

1. AWS region and service configurations.
2. FHIR server settings.
3. Database connection details.
4. HIE integration settings.
5. API Gateway and Lambda function configurations.
6. Environment-specific settings (e.g., sandbox mode).

The directory also contains `tsconfig.json` files that configure TypeScript compilation options for different modules.

In conclusion, this directory serves as the core of the medical data management system, providing comprehensive functionality for handling various aspects of medical information, from patient records to document management and HIE interactions. It plays a crucial role in maintaining data integrity, ensuring proper access control, and facilitating interoperability with external healthcare systems.