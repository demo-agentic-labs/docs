---
title: "store-query-cmd.ts"
---

## High-level description
This file contains test data and helper functions for testing the `store-query-cmd.ts` module, which is responsible for handling the initialization and storage of patient query data, including document query progress and consolidated query progress. 

The file defines various mock objects like `patient`, `dqParams`, `cqParams`, `documentQueryProgress`, and helper functions like `makeConsolidatedQueryProgress`, `makeConsolidatedWebhook` to facilitate testing different scenarios and edge cases related to storing patient query information.

## Code Structure
This file primarily defines a set of variables and helper functions used for testing. The variables like `requestId`, `patient`, `dqParams`, `cqParams`, and `documentQueryProgress` represent different data structures used in the `store-query-cmd` module. 

The helper functions, `makeConsolidatedQueryProgress` and `makeConsolidatedWebhook`, are used to create instances of `ConsolidatedQuery` and `WebhookRequest` objects respectively, populated with either default or custom data for testing purposes.

## References
This section is not included because there are no significant references to other parts of the codebase that are crucial for understanding the current code.

## Symbols

### `requestId`
#### Description
A constant variable storing a randomly generated UUID (v4) string. This ID is likely used to represent a unique request for patient data.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `patient`
#### Description
A constant object representing a patient with an `id` and a `cxId`.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `dqParams`
#### Description
A constant object representing parameters for storing document query progress. It includes the patient's `id` and `cxId`, and a `cmd` object containing details about the document query progress.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `cqParams`
#### Description
A constant object representing parameters for storing consolidated query progress. It includes the patient's `id` and `cxId`, and a `cmd` object containing an array of `consolidatedQueries` with their respective details.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `documentQueryProgress`
#### Description
A constant object representing the progress of a document query. It includes the `requestId`, `startedAt` timestamp, and progress details for `download` and `convert` stages.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `makeConsolidatedQueryProgress`
#### Description
A helper function that creates and returns a `ConsolidatedQuery` object. It takes an optional `params` object to customize the generated query data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | `Partial&lt;ConsolidatedQuery&gt;` | Optional. An object containing partial data to override the default values for the generated `ConsolidatedQuery` object. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| consolidatedQuery | `ConsolidatedQuery` | A `ConsolidatedQuery` object populated with either default or custom data based on the provided `params`. |

#### Internal Logic
The function generates a `ConsolidatedQuery` object with the following logic:
1. It sets the `dateTo` property to a recent date in `YYYY-MM-DD` format.
2. It populates other properties like `requestId`, `status`, `startedAt`, `resources`, `conversionType`, and `dateFrom` either from the provided `params` object or using default values.
3. Finally, it returns the constructed `ConsolidatedQuery` object.

### `mockedPatientAllProgresses`
#### Description
A constant object representing a mocked `PatientModel` with pre-populated data for document query progress and consolidated queries.

#### Inputs
_None_

#### Outputs
_None_

#### Internal Logic
_None_

### `makeConsolidatedWebhook`
#### Description
A helper function that creates and returns a `WebhookRequest` object. It takes an optional `params` object to customize the generated webhook request data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | `Partial&lt;WebhookRequestCreate&gt;` | Optional. An object containing partial data to override the default values for the generated `WebhookRequest` object. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| webhookRequest | `WebhookRequest` | A `WebhookRequest` object populated with either default or custom data based on the provided `params`. |

#### Internal Logic
The function generates a `WebhookRequest` object with the following logic:
1. It populates properties like `cxId`, `requestId`, `type`, `payload`, `status`, `statusDetail`, `requestUrl`, `httpStatus`, and `durationMillis` either from the provided `params` object or using default values.
2. Finally, it returns the constructed `WebhookRequest` object.

## Dependencies
This section is not included because the provided code snippet does not have external dependencies.
