---
title: "test_create_patient_consolidated.py"
---

## High-level description
This code is a test script for creating a consolidated patient record using the Metriport API. It demonstrates how to construct a ConsolidatedBundleUpload object with an Appointment resource and send it to the API to update a patient's consolidated record.

## Symbols

### `test_create_patient_consolidated`
#### Description
This function tests the creation of a consolidated patient record using the Metriport API. It constructs a ConsolidatedBundleUpload object with an Appointment resource and sends it to the API.

#### Inputs
This function doesn't take any explicit inputs, but it uses environment variables for configuration.

#### Outputs
This function doesn't return any value, but it prints the query status to the console.

#### Internal Logic
1. Load environment variables using `load_dotenv()`.
2. Initialize the Metriport client with API key and base URL from environment variables.
3. Create a ConsolidatedBundleUpload object with a single Appointment resource.
4. Call the `create_patient_consolidated` method of the Metriport client with the patient ID and the ConsolidatedBundleUpload object.
5. Print the query status returned by the API call.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| os | To access environment variables |
| dotenv | To load environment variables from a .env file |
| generated.client | To use the Metriport client |
| generated.resources.medical | To use the ConsolidatedBundleUpload class |

## Configuration
The script uses the following environment variables:
| Option | Type | Description |
|:-------|:-----|:------------|
| API_KEY | string | The API key for authenticating with the Metriport API |
| PATIENT_ID | string | The ID of the patient for whom the consolidated record is being created |
| BASE_URL | string | The base URL of the Metriport API |

## Error Handling
This script does not implement explicit error handling. Any exceptions raised during the API call will propagate up and potentially cause the test to fail.

## Logging
The script uses a simple print statement to log the query status returned by the API call.