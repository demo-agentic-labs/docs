---
title: "test_get_medical_record.ts"
---

## High-level description
This code contains unit tests for the MetriportClient's medical record retrieval functionality. It tests two main operations: getting a medical record summary and checking the status of a medical record summary for a specific patient.

## Code Structure
The code sets up the testing environment, initializes a MetriportClient instance, and defines two test cases within a test suite for medical record operations.

## Symbols

### `describe("Get MR test", () =&gt; { ... })`
#### Description
This is a Jest test suite that groups related test cases for medical record operations.

#### Internal Logic
The suite contains two test cases: one for getting a medical record summary and another for checking the status of a medical record summary.

### `test("get medical record", async () =&gt; { ... })`
#### Description
This test case verifies the functionality of retrieving a medical record summary for a patient.

#### Internal Logic
1. Creates a `MedicalRecordSummaryRequest` object with `conversionType` set to "pdf".
2. Calls `metriport.medical.patient.getMedicalRecordSummary` with the patient ID and request object.
3. Logs the received medical record URL.

### `test("get medical record status", async() =&gt; { ... })`
#### Description
This test case checks the functionality of retrieving the status of a medical record summary for a patient.

#### Internal Logic
1. Calls `metriport.medical.patient.getMedicalRecordSummaryStatus` with the patient ID.
2. Logs the received medical record status.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dotenv | For loading environment variables from a .env file |
| path | For resolving file paths |
| MetriportClient | The main client for interacting with the Metriport API |
| MedicalRecordSummaryRequest | Type definition for the medical record summary request |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| apiUrl | string | process.env.BASE_URL | The base URL for the API |
| apiToken | string | process.env.API_KEY | The API key for authentication |
| patientId | string | process.env.PATIENT_ID | The ID of the patient for which to retrieve medical records |

## Error Handling
The code includes basic error handling by throwing an error if required environment variables are not set.

```typescript
if (!apiUrl || !apiToken || !patientId) {
  throw new Error("Required environment variables are not set");
}
```

This ensures that the tests will fail early if the necessary configuration is not provided.