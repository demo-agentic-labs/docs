---
title: "test_match_patient.ts"
---

## High-level description
This code is a test suite for the patient matching functionality in the Metriport SDK. It creates a patient, then attempts to match that patient using demographic data, verifying the SDK's ability to create and match patients accurately.

## Code Structure
The code imports necessary dependencies, sets up environment variables, initializes the MetriportClient, and defines a test case for patient matching.

## Symbols

### `describe("Patient tests", () =&gt; {...})`
#### Description
This is a Jest test suite that groups related tests for patient operations.

### `test("match a patient", async () =&gt; {...})`
#### Description
This test case creates a patient and then attempts to match the same patient using demographic data.

#### Internal Logic
1. Creates patient data (`patientData`) with personal information.
2. Prepares a create request (`createRequest`) with the patient data and facility ID.
3. Creates a patient using the SDK's `create` method.
4. Prepares demographic data (`patientDemoData`) matching the created patient.
5. Attempts to match the patient using the SDK's `match` method.
6. Logs the matched patient's ID.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dotenv | Load environment variables from a .env file |
| path | Resolve file paths |
| MetriportClient | Main SDK client for interacting with the Metriport API |
| BasePatient, Demographics, PatientCreate | Types for patient-related data |
| UsState, Address | Types for address-related data |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| apiUrl | string | undefined | Base URL for the API |
| apiToken | string | undefined | API key for authentication |
| facilityId | string | undefined | ID of the facility |

## Error Handling
The code throws an error if required environment variables are not set.

## API/Interface Reference
| Method | Request | Response | Description |
|:-------|:--------|:---------|:------------|
| metriport.medical.patient.create | PatientCreate | Not specified | Creates a new patient |
| metriport.medical.patient.match | Demographics | \{ id: string \} | Matches a patient based on demographic data |

## Notes
1. The test creates a patient and then immediately tries to match it. In a real-world scenario, there might be a delay between these operations.
2. The test doesn't include assertions to verify the match's correctness. Adding expectations would improve the test's reliability.
3. The code uses environment variables for configuration, which is a good practice for managing sensitive information.
4. The patient data includes detailed information like driver's license and address, which are important for accurate matching.
