---
title: "test_start_doc_query.ts"
---

## High-level description
This code is a test file for the document query functionality of the MetriportClient. It sets up the environment, initializes the client, and tests the `startQuery` method of the document resource in the medical API.

## Code Structure
The code imports necessary dependencies, sets up environment variables, initializes the MetriportClient, and defines a test case for starting a document query.

## Symbols

### `describe` block
#### Description
This is a Jest test suite that groups related tests for Document Query functionality.

### `test` block
#### Description
This is a Jest test case that verifies the `startQuery` method of the document resource.

#### Internal Logic
1. Logs a message indicating the start of the query.
2. Creates a `StartDocumentQueryRequest` object with `facilityId` and `patientId`.
3. Calls the `startQuery` method of the MetriportClient's medical document resource.
4. Logs the response.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dotenv | For loading environment variables from a .env file |
| path | For resolving file paths |
| MetriportClient | The main client for interacting with the Metriport API |
| StartDocumentQueryRequest | Type definition for the request object |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| apiUrl | string | undefined | The base URL for the API, loaded from environment variable BASE_URL |
| apiToken | string | undefined | The API key for authentication, loaded from environment variable API_KEY |
| patientId | string | undefined | The ID of the patient, loaded from environment variable PATIENT_ID |
| facilityId | string | undefined | The ID of the facility, loaded from environment variable FACILITY_ID |

## Error Handling
The code includes basic error handling by throwing an error if any of the required environment variables are not set.

```typescript
if (!apiUrl || !apiToken || !patientId || !facilityId) {
  throw new Error("Required environment variables are not set");
}
```

## Notes
1. This test file is designed to be run in a local environment with a .env file containing the necessary configuration.
2. The test is using Jest as the testing framework, as evidenced by the use of `describe` and `test` functions.
3. The actual assertion of the test result is not implemented in this code snippet. It only logs the response, which suggests this might be a work in progress or meant for manual verification.
4. The MetriportClient is initialized with a custom environment and apiKey, which are functions returning the respective values. This allows for dynamic configuration of the client.