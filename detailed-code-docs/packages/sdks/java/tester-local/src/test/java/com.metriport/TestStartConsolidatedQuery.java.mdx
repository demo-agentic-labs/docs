---
title: "TestStartConsolidatedQuery.java"
---

## High-level description
This code is a JUnit test class that demonstrates how to use the Metriport SDK to start a consolidated query for patient data. It specifically tests the `startConsolidatedQuery` method of the Metriport client, focusing on retrieving Encounter resources for a specific date range and converting the result to PDF format.

## Symbols

### TestStartConsolidatedQuery
#### Description
This is the main test class that contains a single test method to demonstrate the usage of the Metriport SDK for starting a consolidated query.

### startConsolidatedQuery
#### Description
This is a JUnit test method that demonstrates the process of initializing the Metriport client, creating a request for consolidated patient data, and executing the query.

#### Internal Logic
1. Loads environment variables using Dotenv.
2. Initializes the Metriport client with the API key and base URL.
3. Creates a `GetPatientConsolidatedData` request object with specific parameters.
4. Calls the `startConsolidatedQuery` method on the Metriport client.
5. Prints the response or handles any errors that occur during the process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | This method doesn't take any parameters as it's a test method. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | void | This method doesn't return a value. It prints the response to the console. |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| com.metriport.generated.Metriport | Main Metriport SDK client |
| com.metriport.generated.resources.medical.fhir.requests.GetPatientConsolidatedData | Request object for consolidated data query |
| io.github.cdimascio.dotenv.Dotenv | Loading environment variables |
| org.junit.jupiter.api.Test | JUnit 5 test annotation |
| com.metriport.generated.core.ApiError | Custom API error handling |

## Error Handling
The code implements a multi-catch block to handle different types of exceptions:
1. `ApiError`: Handles specific API-related errors.
2. `RuntimeException`: Catches any runtime exceptions.
3. `Exception`: Catches any other general exceptions.

For each type of error, the code prints the error message and stack trace to the console.

## Configuration
The code uses environment variables for configuration:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| API_KEY | String | N/A | API key for authenticating with the Metriport service |
| PATIENT_ID | String | N/A | ID of the patient for whom to retrieve data |
| BASE_URL | String | N/A | Base URL of the Metriport API |

These variables are loaded from a .env file using the Dotenv library.