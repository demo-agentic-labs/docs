---
title: "handlebars-helpers.test.js"
---

## High-level description
This file contains unit tests for Handlebars helpers used in the FHIR converter. It tests various functions related to extracting reference ranges, building presented forms, and handling date-time conversions. The tests ensure that these helpers correctly process different input formats and edge cases.

## Code Structure
The code is organized into two main test suites: "Handlebars helpers" and "getDateTime". The first suite tests various helper functions, while the second focuses specifically on date-time parsing and formatting.

## Symbols

### `describe("Handlebars helpers", ...)`
#### Description
This test suite checks the functionality of various Handlebars helper functions, particularly `extractReferenceRange` and `buildPresentedForm`.

#### Internal Logic
1. Defines an array of test cases (`opTests`) with inputs and expected outputs.
2. Iterates through the test cases, running each one as a separate test.
3. Compares the actual output of the helper function with the expected output.
4. Also includes a section for error tests (`opErrorTests`), which is currently empty.

### `describe("getDateTime", ...)`
#### Description
This test suite focuses on the `getDateTime` function, testing its ability to parse and format various date-time strings.

#### Internal Logic
Contains multiple test cases for different date-time formats, including:
- Full date-time strings
- Partial date strings (year, year-month, year-month-day)
- Date-time strings with timezones
- ISO 8601 formatted strings
- Edge cases and invalid inputs

### `function getHelper(helperName)`
#### Description
A utility function to retrieve a helper function by its name from the `helpers` array.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| helperName | string | The name of the helper function to retrieve |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| helper | object | The helper function object with `name` and `func` properties |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| inputs | Provides test input data for reference range extraction |
| presentedForm | Provides test input data for building presented forms |
| helpers | Contains the external Handlebars helper functions being tested |
| functions | Contains the internal functions being tested, including `getDateTime` |

## Notes
- The test file imports test data from separate files (`extract-range-templates.js` and `build-presented-form-templates.js`) to keep the test cases organized and maintainable.
- The `opErrorTests` array is currently empty, suggesting that error handling tests might be added in the future.
- The `getDateTime` function is tested extensively with various input formats, indicating its importance in the FHIR conversion process.