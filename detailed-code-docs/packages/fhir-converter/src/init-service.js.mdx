---
title: "init-service.js"
---

## High-level description
This code initializes the service by ensuring the existence of a template files directory and populating it with base templates if empty. It also cleans up any temporary folders created during template updates.

## Code Structure
The code uses the `fs-extra` library to perform file system operations. It checks the template files location, copies base templates if needed, and removes temporary folders.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| fs-extra | Enhanced file system operations |
| path | Handling file and directory paths |

## Symbols

### Anonymous Function (Main execution)
#### Description
This is the main function that executes when the script is run. It ensures the template files directory exists and then performs necessary operations based on its content.

#### Internal Logic
1. Ensures the template files directory exists using `fse.ensureDir()`.
2. Reads the contents of the template files directory.
3. If the directory is empty, copies base templates to it.
4. If the directory is not empty, removes any temporary folders.

### Anonymous Function (Copy completion callback)
#### Description
This empty function is called after the base templates are copied successfully. It doesn't perform any operations.

### Anonymous Function (Directory reading callback)
#### Description
This function is called after reading the contents of the template files directory. It decides whether to copy base templates or clean up temporary folders.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| err | Error | Error object if reading directory fails |
| files | Array | List of files in the directory |

#### Internal Logic
1. Checks if the directory is empty (files.length == 0).
2. If empty, copies base templates to the directory.
3. If not empty, reads existing files and removes temporary folders.

### Anonymous Function (Temporary folder removal)
#### Description
This function is called for each file in the template files directory to remove temporary folders.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fl | String | File or folder name |

#### Internal Logic
1. Checks if the file/folder name starts with ".temp".
2. If it does, constructs the full path and removes the folder.
3. Logs any errors encountered during removal.

## Error Handling
The code includes basic error handling for file removal operations, logging errors to the console.

## Logging
The code uses `console.log` to output information about removed temporary folders and any errors encountered during the process.

## TODOs
There are no explicit TODOs in the code.