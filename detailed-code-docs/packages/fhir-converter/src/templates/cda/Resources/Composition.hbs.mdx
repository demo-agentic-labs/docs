---
title: "Composition.hbs"
---

## High-level description
This Handlebars template generates a FHIR Composition resource from CDA (Clinical Document Architecture) data. It structures the CDA information into a FHIR-compliant JSON format, including details such as identifiers, status, type, date, title, confidentiality, attesters, events, and sections.

## Symbols

### Main Template
#### Description
The main template creates a FHIR Composition resource structure, populating it with data from the CDA input.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| composition | Object | The CDA composition object containing various fields to be mapped to FHIR |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| JSON | Object | A FHIR Composition resource in JSON format |

#### Internal Logic
1. Generates a unique ID for the Composition resource
2. Maps CDA fields to corresponding FHIR Composition fields
3. Handles attester information, including legal authenticator details
4. Processes event information
5. Iterates through CDA sections, mapping them to FHIR sections
6. Determines the appropriate resource type for each section entry
7. Generates references to other resources based on section content

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| DataType/CodeableConcept.hbs | Used to format code concepts |
| DataType/Period.hbs | Used to format time periods |
| Utils/GeneratePractitionerId.hbs | Generates practitioner IDs |
| Utils/ResourceTypeFromSection.hbs | Determines resource type from section data |
| Utils/DisplayFromSectionEntry.hbs | Formats display information for section entries |

## Error Handling
The template uses conditional statements to handle missing or optional data, providing default values or omitting fields when necessary.

## TODOs
1. Missing use mapping for the identifier
2. Missing status mapping for the Composition resource