---
title: "RelatedPerson.hbs"
---

## High-level description
This Handlebars template file defines the structure for creating a FHIR RelatedPerson resource. It transforms data from a CDA (Clinical Document Architecture) format into a FHIR-compliant JSON representation of a RelatedPerson, including details such as identifiers, relationships, gender, name, contact information, birth date, address, and communication preferences.

## Symbols

### RelatedPerson Resource
#### Description
This is the main structure of the template, representing a FHIR RelatedPerson resource. It includes various attributes of a related person, such as identifiers, relationships, gender, name, contact information, birth date, address, and communication preferences.

#### Inputs
The template uses various input data, presumably from a CDA document, referenced through Handlebars expressions like `{{relatedPerson.id}}`, `{{relatedPerson.code}}`, etc.

#### Internal Logic
1. Generates a unique identifier for the resource.
2. Maps CDA identifiers to FHIR identifiers.
3. Determines relationships and roles using helper templates.
4. Maps gender information.
5. Transforms name data into FHIR HumanName format.
6. Converts contact information to FHIR ContactPoint format.
7. Formats birth date.
8. Transforms address information to FHIR Address format.
9. Maps language communication preferences.

### Helper Templates
The template uses several helper templates for specific data transformations:

1. `DataType/Identifier.hbs`
2. `Utils/RelatedPersonCodeFromText.hbs`
3. `DataType/Coding.hbs`
4. `Utils/ContactRoleCode.hbs`
5. `ValueSet/AdministrativeGender.hbs`
6. `DataType/HumanName.hbs`
7. `DataType/ContactPoint.hbs`
8. `DataType/Address.hbs`
9. `ValueSet/Language.hbs`

These helpers are used to transform specific parts of the CDA data into FHIR-compliant formats.

## Dependencies
The template relies on several helper functions and value sets, which are likely defined in other files within the project:

1. `toArray`: Converts a value to an array.
2. `evaluate`: Executes another template and returns its result.
3. `trimAndLower`: Trims and converts a string to lowercase.
4. `parseReferenceData`: Parses reference data.
5. `trimAndUpper`: Trims and converts a string to uppercase.
6. `addHyphensDate`: Formats a date by adding hyphens.

## Configuration
The template uses FHIR-specific URLs and systems:

1. `"http://hl7.org/fhir/ValueSet/languages"`: Used for language coding.
2. `"RelatedPerson/{{ID}}"`: Used as the resource URL in the request object.

## Error Handling
There is no explicit error handling in this template. It relies on the correctness of the input data and the helper functions.

## API/Interface Reference
The template generates a FHIR RelatedPerson resource, which adheres to the FHIR specification. The resulting JSON object can be used in FHIR API requests, as indicated by the `request` object at the end of the template.