---
title: "Overview"
---

## High-level description
This directory contains test files for the network-related functionality in the Metriport application. It includes tests for Axios mocking utilities and network retry mechanisms. The tests cover various scenarios, including different types of network errors, HTTP status codes, and retry behaviors.

## What does it do?
The test files in this directory serve to verify the correct functioning of network-related operations in the Metriport application. They focus on two main areas:

1. Axios Mocking: It provides utilities to create mock Axios instances and responses for use in Jest tests. This allows developers to simulate various network scenarios without making actual HTTP requests.

2. Network Retry Mechanism: It tests the application's ability to handle network errors and retry failed requests. This includes testing different types of network errors (e.g., connection refused, timeout), HTTP status codes, and configurable retry behaviors.

These tests ensure that the application can handle various network conditions robustly, improving its reliability and user experience.

## Key Files

1. `axios.ts`:
   This file contains utility functions for mocking Axios in Jest tests. It includes:
   - `mockAxios()`: Creates a mock implementation of Axios and its main HTTP methods.
   - `makeAxiosResponse()`: Generates mock Axios response objects with customizable properties.
   - `errorWithCauseAxiosError`: A complex error object structure for testing error handling scenarios.

2. `retry.test.ts`:
   This file contains the actual test suite for the network retry functionality. It includes tests for:
   - `executeWithNetworkRetries`: The main function responsible for retrying network operations.
   - `getHttpCodeFromError`: A utility function for extracting HTTP codes from errors.
   - `getHttpStatusFromError`: A utility function for extracting HTTP status codes from errors.

The tests cover various scenarios, including different types of network errors (ECONNREFUSED, ECONNRESET, ETIMEDOUT), HTTP status codes, and configurable retry behaviors.

## Dependencies
The test files rely on the following external libraries and internal modules:

1. External libraries:
   - `axios`: Used for creating and handling Axios errors in tests.
   - `@faker-js/faker`: Utilized for generating fake data in tests.
   - `jest`: The testing framework used for writing and running the tests.

2. Internal modules:
   - `../../common/retry`: Contains retry-related functions being tested.
   - `../../error/metriport-error`: Provides the `MetriportError` class for error handling.
   - `../retry`: Contains the main retry functions being tested.

## Configuration
While there are no explicit configuration files in this directory, the tests demonstrate the use of configurable options in the retry mechanism:

- `retryOnTimeout`: A boolean option to control whether timeouts should trigger retries.
- `httpCodesToRetry`: An array of HTTP status codes that should trigger retries.
- `maxAttempts`: The maximum number of retry attempts (set to 2 in the tests for quick execution).

These configuration options allow developers to fine-tune the retry behavior based on specific application requirements.

The tests in this directory play a crucial role in ensuring the reliability and robustness of the Metriport application's network operations. By covering various error scenarios and retry behaviors, they help maintain the quality of the network-related functionality and provide confidence in the application's ability to handle different network conditions.