---
title: "duration.ts"
---

## High-level description
This code provides a utility function `logDuration` for measuring and logging the execution time of asynchronous functions. It uses the `dayjs` library for time calculations and formatting, and includes options for customizing the logging output.

## Symbols

### `logDuration`
#### Description
This asynchronous function wraps another asynchronous function, measures its execution time, and logs the duration. It supports optional parameters for customizing the log output.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fn | () =&gt; Promise&lt;T&gt; | The asynchronous function to be measured |
| options | Object | Optional configuration for logging |
| options.log | typeof console.log | Custom logging function (default: console.log) |
| options.withMinutes | boolean | Whether to include duration in minutes (default: true) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| T | Any | The result of the executed function |

#### Internal Logic
1. Destructure options with default values.
2. Record the start time.
3. Execute the provided function and track its success.
4. Calculate the duration.
5. Format the duration message, including minutes if specified.
6. Log the execution time with success status.
7. Return the result of the executed function.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dayjs | Date and time manipulation library |
| dayjs/plugin/duration | Plugin for duration calculations |
| ./numbers | Module containing the `formatNumber` function |

## References
- The `formatNumber` function is imported from the `./numbers` module and used to format the duration in minutes.

## Performance Considerations
The function adds a small overhead to the execution time of the wrapped function due to time calculations and logging. This overhead is generally negligible but should be considered in performance-critical scenarios.

## Error Handling
The function uses a try-finally block to ensure that the duration is logged even if the wrapped function throws an error. It also includes an error status in the log message if the execution fails.