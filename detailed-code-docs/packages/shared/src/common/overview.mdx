---
title: "Overview"
---

## High-level description
This directory contains a collection of utility functions and types that are shared across the project. It includes functions for handling arrays, booleans, dates, durations, emails, environment variables, errors, numbers, strings, and more. These utilities provide common functionality that can be reused throughout the codebase, promoting consistency and reducing code duplication.

## What does it do?
The `common` directory provides a set of helper functions and types that perform various tasks:

1. Array manipulation: Converting various input types to arrays.
2. Boolean operations: Determining if a value should be considered true.
3. Date handling: Validating ISO dates and calculating elapsed time.
4. Duration logging: Measuring and logging execution time of asynchronous functions.
5. Email processing: Extracting domain names from email addresses.
6. Environment variable management: Retrieving and validating environment variables.
7. Error handling: Converting errors to strings with different levels of detail.
8. Number formatting: Converting strings to floats and formatting numbers.
9. String manipulation: Limiting string length, converting to title case, and removing non-numeric characters.
10. URL validation: Checking if a string is a valid URL.
11. Object Identifier (OID) normalization: Validating and standardizing OIDs.
12. Retry mechanisms: Implementing retry logic with exponential backoff for asynchronous operations.
13. National Provider Identifier (NPI) validation: Checking the validity of NPI numbers.

These utilities are designed to be used across different parts of the application, providing consistent behavior and reducing the need to reimplement common functionality.

## Key Files

1. `array.ts`: Contains the `toArray` function for converting inputs to arrays.
2. `boolean.ts`: Provides the `isTrue` function for boolean value checking.
3. `date.ts`: Includes functions for validating ISO dates and calculating elapsed time.
4. `duration.ts`: Contains the `logDuration` function for measuring execution time.
5. `email.ts`: Provides the `getDomainFromEmailWithoutTld` function for email domain extraction.
6. `env-var.ts`: Contains functions for handling environment variables.
7. `error.ts`: Includes functions for converting errors to strings.
8. `numbers.ts`: Provides functions for number formatting and random integer generation.
9. `retry.ts`: Implements retry mechanisms with exponential backoff.
10. `string.ts`: Contains functions for string manipulation and formatting.
11. `validate-npi.ts`: Provides the `validateNPI` function for NPI number validation.

These files contain the core utility functions that are used throughout the project to handle common tasks and provide consistent behavior across different modules.

## Dependencies
The common utilities use the following external libraries:

1. dayjs: Used for date parsing and manipulation in `date.ts` and `duration.ts`.
2. zod: Used for creating and validating schemas in `date.ts`.
3. lodash: Used for various utility functions, including `random` in `retry.ts` and `startCase` in `titleCase.ts`.
4. @medplum/fhirtypes: Used for FHIR-related types in `metriport-organization.ts`.

These dependencies are chosen to provide robust and well-tested implementations of common functionality, reducing the need for custom implementations and improving overall code reliability.

## Configuration
While most of the utility functions don't require specific configuration, some files use environment variables or constants that may need to be configured:

1. `env-var.ts`: Relies on the `ENV_TYPE` environment variable to determine the current environment.
2. `retry.ts`: Uses configurable options for retry attempts, delays, and conditions.

These configuration options allow for flexibility in how the utilities are used across different parts of the application and in different environments.

The common utilities in this directory form a foundation for many operations throughout the project, providing consistent and reliable implementations of frequently needed functionality. By centralizing these utilities, the codebase maintains better consistency and reduces the likelihood of errors that could arise from multiple implementations of the same functionality.