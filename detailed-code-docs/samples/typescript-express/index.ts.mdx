---
title: "index.ts"
---

## High-level description
This code implements a TypeScript Express application that demonstrates the usage of the Metriport Medical API. It creates a patient, starts a document query for that patient, and logs the response.

## Code Structure
The main function `main()` orchestrates the API calls, creating a patient and starting a document query. It uses the `MetriportMedicalApi` client from the Metriport API SDK to interact with the API.

## Symbols

### `main()`
#### Description
An asynchronous function that demonstrates the usage of the Metriport Medical API by creating a patient and starting a document query.

#### Internal Logic
1. Retrieves the facility ID from environment variables.
2. Creates a patient using the Metriport client.
3. Starts a document query for the created patient.
4. Logs the response from the document query.

### `metriportClient`
#### Description
An instance of the `MetriportMedicalApi` class, initialized with the API key and base address.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| apiKey | string | The Metriport API key |
| options | object | Configuration options including the base address |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dotenv | Load environment variables from a .env file |
| @metriport/api-sdk | Metriport API SDK for interacting with the Medical API |
| @metriport/shared | Shared utilities for Metriport |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| METRIPORT_API_KEY | string | N/A | API key for authenticating with Metriport |
| IS_PROD | string | N/A | Flag to determine if the application is running in production |
| FACILITY_ID | string | N/A | ID of the facility used in API calls |

## Error Handling
The code uses try-catch blocks within the async functions to handle potential errors, although error handling is not explicitly shown in this snippet.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /patient | POST | PatientCreate object | PatientDTO | Creates a new patient |
| /document/query | POST | Patient ID, Facility ID | DocumentQuery | Starts a document query for a patient |

This code serves as a basic example of how to use the Metriport Medical API to create a patient and start a document query. It demonstrates the initialization of the API client, making API calls, and handling responses.