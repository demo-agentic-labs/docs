---
title: "restart_api_staging.yml"
---

## High-level description
This GitHub Actions workflow file, named "Restart API - Staging," is designed to restart the API service in the staging environment. It uses a reusable workflow to perform the restart operation on an Amazon ECS (Elastic Container Service) cluster.

## Code Structure
The workflow consists of a single job named "restart" that utilizes a reusable workflow defined in `_restart-ecs.yml`. It passes various environment-specific parameters and secrets to the reusable workflow.

## Symbols

### `restart` (job)
#### Description
This job is responsible for restarting the API service in the staging environment. It uses a reusable workflow defined in `_restart-ecs.yml` to perform the actual restart operation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| deploy_env | string | The deployment environment, set to "staging" |
| ECR_REPO_URI | string | The URI of the ECR repository for staging |
| ECS_CLUSTER | string | The name of the ECS cluster for staging |
| ECS_SERVICE | string | The name of the ECS service for staging |
| AWS_REGION | string | The AWS region for the staging API |

#### Secrets
| Name | Description |
|:-----|:------------|
| AWS_ACCESS_KEY_ID | AWS access key ID for authentication |
| AWS_SECRET_ACCESS_KEY | AWS secret access key for authentication |
| DOCKERHUB_USERNAME | DockerHub username for authentication |
| DOCKERHUB_TOKEN | DockerHub token for authentication |

#### Internal Logic
1. The job uses the reusable workflow defined in `_restart-ecs.yml`.
2. It passes the specified inputs and secrets to the reusable workflow.
3. The actual restart logic is implemented in the reusable workflow.

## Dependencies
This workflow depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| ./.github/workflows/_restart-ecs.yml | Reusable workflow for restarting ECS services |

## Configuration
The workflow uses GitHub Actions variables and secrets for configuration:
| Option | Type | Description |
|:-------|:-----|:------------|
| vars.ECR_REPO_URI_STAGING | string | URI of the ECR repository for staging |
| vars.ECS_CLUSTER_STAGING | string | Name of the ECS cluster for staging |
| vars.ECS_SERVICE_STAGING | string | Name of the ECS service for staging |
| vars.API_REGION_STAGING | string | AWS region for the staging API |

## Error Handling
Error handling is not explicitly defined in this workflow file. It likely relies on the error handling mechanisms implemented in the reusable workflow (`_restart-ecs.yml`) and GitHub Actions' default error handling.

## Logging
Logging is not explicitly defined in this workflow file. It likely relies on GitHub Actions' default logging mechanisms and any logging implemented in the reusable workflow.